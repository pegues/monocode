/**
 * Version: Monocode 0.2
 * URL: http://www.monocode.io
 * Description: Monocode Code Editor.
 */
!function($){var base,editors=[],myLayout,files=[],timer;$.sceditor=function(el,op){function launchFullscreen(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}function beautify(a){var b=base.getEditorInstance(base.tab.getActiveId()).instance,c=require("ace/token_iterator").TokenIterator,d=0,e=0,f=-1;if(a){var g=b.selection.getRange();d=g.start.row,e=g.start.column,f=g.end.row}for(var p,q,s,h=new c(b.getSession(),d,e),i=h.getCurrentToken(),j="",k=[{type:"support.php_tag",value:"<?php"},{type:"support.php_tag",value:"<?"},{type:"support.php_tag",value:"?>"},{type:"paren.lparen",value:"{",indent:!0},{type:"paren.rparen",value:"}",indent:!1},{type:"text",value:";"},{type:"meta.tag.punctuation.tag-close.xml",value:">"},{type:"meta.tag.punctuation.tag-open.xml",value:"<",blockTag:!0,indent:!0,dontBreak:!0},{type:"meta.tag.punctuation.end-tag-open.xml",value:"</",blockTag:!0,indent:!1,dontBreak:!0},{type:"punctuation.operator",value:";",after:!0}],l=[{type:"entity.other.attribute-name",prepend:!0},{type:"storage.type",value:"var",append:!0},{type:"keyword.operator",value:"="},{type:"keyword",value:"as",prepend:!0,append:!0}],m=["html","head","script","style","body","table","tr","td","div","ul","li","form","br"],n=0,o=!1,r={},t={};i&&(f==-1||h.getCurrentTokenRow()<=f);)if(t=h.stepForward(),t&&"meta.tag.tag-name"==t.type.substr(0,17)&&(s=t.value),"support.php_tag"==r.type&&"<?="==r.value&&(o=!0),"meta.tag.tag-name"==i.type&&(i.value=i.value.toLowerCase()),"text"==i.type&&(i.value=i.value.trim()),i.value){for(var u in l)i.type!=l[u].type||l[u].value&&i.value!=l[u].value||(l[u].prepend&&(i.value=" "+i.value),l[u].append&&(i.value+=" "));if("meta.tag.tag-name"==i.type.substr(0,17)&&(p=i.value),!o){for(u in k)if(i.type==k[u].type&&i.value==k[u].value&&(!k[u].blockTag||m.indexOf(s)!==-1)){k[u].indent===!1&&n--;break}for(u in k)if(r.type==k[u].type&&r.value==k[u].value&&(!k[u].blockTag||m.indexOf(p)!==-1)){if(k[u].indent===!0&&n++,!k[u].dontBreak)for(j+="\n",u=0;u<n;u++)j+="\t";break}}if(j+=i.value,"support.php_tag"==i.type&&"?>"==i.value&&(o=!1),q=p,r=i,i=t,!i)break}else i=t;if(f==-1)b.setValue(j);else{var v=b.selection.getRange();b.session.remove(v),b.session.insert(v.start,j)}b.focus()}base=this,base.$el=$(el),base.el=el,base.thisEl=null,base.$el.data("sceditor",base),base.init=function(){function toggleLiveResizing(){$.each($.layout.config.borderPanes,function(a,b){var c=myLayout.options[b];c.livePaneResizing=!c.livePaneResizing})}base.options=$.extend({},$.sceditor.defaultOptions,op),$.ajaxSetup({timeout:9e5});var stateResetSettings={west__size:250,west__initClosed:!1,west__initHidden:!1};myLayout=$("div.wrapper").layout({closable:!0,resizable:!0,slidable:!0,livePaneResizing:!1,togglerLength_open:0,togglerLength_closed:"100%",togglerAlign_open:"center",togglerAlign_closed:"center",spacing_open:1,spacing_closed:1,north__size:20,north__minSize:31,north__spacing_open:0,north__togglerLength_open:0,north__togglerLength_closed:-1,north__resizable:!1,north__slidable:!1,south__size:170,south__minSize:56,south__onresize:function(){base.prepareStage()},south__onhide:function(){base.prepareStage()},south__onshow:function(){base.prepareStage()},south__onopen:function(){base.prepareStage()},south__onclose:function(){base.prepareStage()},south__onopen_end:function(){base.prepareStage()},south__onopen_start:function(){base.prepareStage()},south__onclose_end:function(){base.prepareStage()},south__onclose_start:function(){base.prepareStage()},south__maxSize:500,south__spacing_open:1,south__spacing_closed:0,south__resizeable:!0,south__slidable:!0,south__initClosed:!0,south__showOverflowOnHover:!0,south__fxSpeed_size:"fast",south__fxSpeed_open:0,east__size:35,east__spacing_open:1,east__togglerLength_open:0,east__togglerLength_closed:-1,east__resizable:!1,east__slidable:!1,east__fxName:"none",west__showOverflowOnHover:!0,west__animatePaneSizing:!1,west__fxSpeed_size:"fast",west__fxSpeed_open:0,west__minSize:170,west__maxSize:600,west__spacing_open:1,west__spacing_closed:8,maskPanesEarly:!0,center__maskIframesOnResize:"iframe",center__contentIgnoreSelector:".ui-layout-mask",south__maskIframesOnResize:"iframe",south__contentIgnoreSelector:".ui-layout-mask",stateManagement__enabled:!0,showDebugMessages:!0}),$("input#openner").change(function(a){base.fileHasBeenOpened()}),$("body").on("click","[data-event-target-id]",function(){$(".optionstoolitem").removeClass("active"),$(this).find(".optionstoolitem").addClass("active"),$('[data-layout-type="left_manager"]').removeClass("active"),$('[data-manager-id="'+$(this).data("event-target-id")+'"]').addClass("active");var a=$(this).data("event-target-id");"files_manager_container"==a?(base.file.reload(),base.file.reloadProjects()):"workspace_manager_container"==a?base.loadWorkshop():"ftps_manager_container"==a?base.ftp.reloadList():"database_manager_container"==a&&base.loadDatabases()}),$("#tempMemory").click(function(){base.resetConfiguration({key:$(this).attr("data-key"),value:$(this).attr("data-value")})}),$(window).resize(function(){base.prepareStage()}),$("body").on("click",".tabsButton",function(){if("undefined"!=typeof $(this).data("fram-id")&&""!=$(this).data("fram-id")){var _controls=$(this).data("action");if("undefined"!=typeof _controls)if("close"==_controls||"cancle"==_controls){try{eval("document.getElementById('"+$(this).data("fram-id")+"').contentWindow."+_controls+"()")}catch(a){}base.tab.close(base.tab.getActiveId())}else try{eval("document.getElementById('"+$(this).data("fram-id")+"').contentWindow."+_controls+"()")}catch(a){alert("Function not found to execute.")}}}),$("body").on("click",".ftpsavedgrid .ftprowitem",function(){}),$("ul.ftpconnectionslist").on("click","li.ftpitem div.name",function(){$(this).parent().parent().hasClass("active")?$(this).parent().parent().removeClass("active"):$(this).parent().parent().addClass("active")}),$("body").on("click","[data-action],[data-file-url]",function(e){if(e.stopPropagation(),e.preventDefault(),base.thisEl=$(this),!$(this).parent().hasClass("disable")&&!$(this).hasClass("disabled")){$(this).next().hasClass("sitenavdropdown")||$(this).parents("ul.sitenavdropdown.primary").hide();var type=$(this).data("action-type");if("command"==type)base.command.execute($(this).data("action"));else if("calljs"==type)eval("base."+$(this).data("action")+"()");else if("popup"==$(this).data("action-type")){var url=$(this).data("file-url");url||(url=$(this).data("action")),base.openPopup({url:url,title:$(this).data("title")})}else if("opentab"==$(this).data("action-type")){var u="undefined"!=typeof $(this).data("action")&&""!=$(this).data("action")?$(this).data("action"):$(this).data("file-url");base.tab.openSystem({url:u,title:$(this).data("title")})}return!1}}),base.loadWorkshop(),base.tab.init(),base.initActivity(),base.command.init(op.commands),base.disableMenus($(this)),base.sessionValidator.start(),base.layout.init(op.layout_options),base.widget.init(op.widgets,op.widget_options)},base.layout=function(){return $(".footerpane .footerpanesectionclose").click(function(){base.layout.closePane($(this).closest(".footerpane"))}),$(".ftrfeaturestablist>li").click(function(){base.layout.togglePane($(this).data("pane-name"))}),{init:function(a){if(this.__options=a?a:{},a&&!jQuery.isEmptyObject(a))for(var b in a)1==a[b].open&&this.openPane(b);else this.resizePanel()},getPane:function(a){return $("div.footerpane[data-pane-name='"+a+"']")},closePane:function(a){var b=a.data("pane-name");$(".ftrfeaturestablist > li."+b).removeClass("active"),a.hide(),this.resizePanel(a.parent()),this.saveOption(b,"open",0)},openPane:function(a){var b=this.getPane(a);b.length&&(b.show(),myLayout.open("south"),$(".ftrfeaturestablist>li."+a).addClass("active"),this.resizePanel(b.parent()),this.saveOption(a,"open",1),"terminal"==a&&$(".terminalwrapper iframe").length<=0&&$("<iframe>",{src:base.options.baseUrl+"editor/terminal?domain="+base.workspace.getActive().ws_domain}).appendTo(".terminalwrapper"))},togglePane:function(a){var b=this.getPane(a);b.is(":visible")?this.closePane(b):this.openPane(a)},resizePanel:function(a){var b=$("ul.ftrfeaturestablist>li.active").length;b<2&&$(".footeroutputwrapper_inside").hasClass("splitter_container")&&$(".footeroutputwrapper_inside").enhsplitter("remove"),b<=0?myLayout.close("south"):2!=b||$(".footeroutputwrapper_inside").hasClass("splitter_container")||$(".footeroutputwrapper_inside").enhsplitter({invisible:!0,leftMinSize:100,rightMinSize:100})},__options:null,saveOption:function(a,b,c){"undefined"==typeof this.__options[a]&&(this.__options[a]={}),this.__options[a][b]=c,base.request({url:base.options.baseUrl+"editor/saveLayoutOption",data:{name:a,options:this.__options[a]}})}}}(),base.tab=function(){return{init:function(){$("div.editortabbar").tabs({activate:function(a,b){var c=b.newTab.data("tab-data");if(!c.isNew){if(!c.isActive){if(base.tab.getInstance().widget().find(".ui-tabs-nav>li").each(function(){var a=$(this).data("tab-data");a.isActive=!1,$(this).data("tab-data",a)}),c.isActive=!0,b.newTab.data("tab-data",c),base.tab.isProcessingMultipleTabs())return;base.tab.saveOpenState(c)}b.newTab.hasClass("loaded")||b.newTab.hasClass("loading")||base.tab.load(c,function(){base.disableMenus(),base.prepareStage();var a=base.getEditorInstance(c.id);a&&a.instance.focus()})}base.disableMenus(),base.prepareStage();var d=base.getEditorInstance(c.id);d&&d.instance.focus()}}).find(".ui-tabs-nav").sortable({axis:"x",delay:150,distance:2,stop:function(){base.tab.refreshWidget(),base.tab.saveAllOpenState()}}).find("li").remove(),$("div.editortabbar").on("click",".close",function(a){a.preventDefault(),a.stopPropagation(),base.file.close($(this).closest("li").attr("data-tab-id"))}).on("mouseup","a.ui-tabs-anchor",function(a){a&&2==a.which&&(a.preventDefault(),a.stopPropagation(),base.file.close($(this).closest("li").attr("data-tab-id")))}),$(".tabcontrolarrow.arrowleft").mousedown(base.tab.startMovingToLeft).mouseleave(base.tab.stopMoving),$(".tabcontrolarrow.arrowright").mousedown(base.tab.startMovingToRight).mouseleave(base.tab.stopMoving),$("body").mouseup(base.tab.stopMoving),$(".tabdropdownfileslist").on("click","li",function(){$("#panel_nav_"+$(this).data("tab-id")).find("a.ui-tabs-anchor").click()});var a={alias:"filetabcontextmenu",width:230,items:[{text:"Close",alias:"close",action:base.tab.contextmenu.onClick},{text:"Close All But This Tab",alias:"closeOthers",action:base.tab.contextmenu.onClick},{text:"Close to the Left",alias:"closeLeft",action:base.tab.contextmenu.onClick},{text:"Close to the Right",alias:"closeRight",action:base.tab.contextmenu.onClick},{text:"Close All",alias:"closeAll",action:base.tab.contextmenu.onClick}],onShow:base.tab.contextmenu.onShow,onContextMenu:base.tab.contextmenu.onContextMenu};$("#editorfilelist").contextmenu(a)},contextmenu:{tab:null,onContextMenu:function(a){var b=$(a.target).closest("li",this);return base.tab.contextmenu.tab=b.length?b:null,!0},onShow:function(a){var b=null==base.tab.contextmenu.tab;a.disable("close",b),a.disable("closeOthers",b),a.disable("closeLeft",b),a.disable("closeRight",b)},onClick:function(){switch(this.data.alias){case"close":base.tab.contextmenu.tab.find(".close").click();break;case"closeOthers":base.file.closeOther(base.tab.contextmenu.tab);break;case"closeLeft":base.file.closeLeft(base.tab.contextmenu.tab);break;case"closeRight":base.file.closeRight(base.tab.contextmenu.tab);break;case"closeAll":base.file.closeAll()}}},getInstance:function(){return $("div.editortabbar").tabs("instance")},refreshWidget:function(){this.getInstance().refresh()},Types:{WELCOME:"welcome",SYSTEM:"system",EDITOR:"editor",IMAGE:"image",STATIC:"static"},RemoteTypes:{FTP:"ftp",SFTP:"ftp"},timer:null,interval:500,startMovingToLeft:function(){var a=$("ul#editorfilelist"),b=a.position().left;if(b<0){var c=50;b>-50&&(c=-b),a.css("left",b+c+"px"),clearTimeout(base.tab.timer),base.tab.timer=setTimeout(base.tab.startMovingToLeft,base.tab.interval),500==base.tab.interval&&(base.tab.interval=100)}},startMovingToRight:function(){var a=$("ul#editorfilelist"),b=a.position().left,c=a.parent().width(),d=0;$("ul#editorfilelist > li").each(function(){d+=$(this).width()});var e=d+b-c;if(e>0){var f=50;e<50&&(f=e),a.css("left",a.position().left-f+"px"),clearTimeout(base.tab.timer),base.tab.timer=setTimeout(base.tab.startMovingToRight,base.tab.interval),500==base.tab.interval&&(base.tab.interval=100)}},stopMoving:function(){clearTimeout(base.tab.timer),base.tab.interval=500},getCount:function(){return $(base.options.configAce.tabListUl+">li").length},activate:function(a){var b=$("a[href='#panel_"+a+"']");b.closest("li").hasClass("ui-state-active")||b.click()},getActive:function(){return $(base.options.configAce.tabListUl+">li.ui-state-active")},getActiveId:function(){return this.getActive().data("tab-id")},getActiveData:function(){var a=this.getActive();return a.length>0?a.data("tab-data"):null},getActiveTitle:function(){var a=this.getActiveData();return a?a.title:null},get:function(a){return $(base.options.configAce.tabListUl+">li[data-tab-id='"+a+"']")},getData:function(a){return this.get(a).data("tab-data")},isNewFile:function(a){return this.getData(a).isNew},isRemote:function(a){return this.getData(a).isRemote},isEditor:function(a){return this.getData(a).type==this.Types.EDITOR},getByURL:function(a){return $(base.options.configAce.tabListUl+">li[data-tab-url='"+a+"']")},getAllByURL:function(a){return $(base.options.configAce.tabListUl+">li[data-tab-url^='"+a+"']")},markChanged:function(){var a=this.getActive().find("a.ui-tabs-anchor");a.find("span").length<1&&(a.prepend("<span class='unsaved'><i class='fa fa-asterisk'></i></span>"),base.disableMenus())},markUnchanged:function(a){"object"!=typeof a&&(a=base.tab.get(a)),a.find("a.ui-tabs-anchor span").remove(),base.disableMenus()},hasChanged:function(a){return this.get(a).find("a.ui-tabs-anchor span").length>0},getURL:function(a){return this.get(a).data("tab-url")},getIdByURL:function(a){return this.getByURL(a).data("tab-id")},closeByURL:function(a){var b=this.getAllByURL(a);b.length>0&&b.each(function(){var a=$(this).data("tab-id");base.tab.close(a)})},updateFileById:function(a,b){this.__updateFile(this.get(a),b)},updateFileByURL:function(a,b){var c=this.getByURL(a);c.length<=0||this.__updateFile(c,b)},__updateFile:function(a,b){var c=a.data("tab-id"),d=a.data("tab-data");d.id=b.id,d.url=b.url,d.title=b.name,d.isNew=!1,a.attr("id","panel_nav_"+b.id).attr("data-tab-id",b.id).data("tab-id",b.id).attr("data-tab-url",b.url).data("tab-url",b.url).data("tab-data",d).attr("aria-controls","panel_"+b.id);var e=a.find("a.ui-tabs-anchor"),f=e.html();e.html(f.replace(f.replace(/<span.*?>.*?<\/span>/m,"").trim(),b.name)).attr("href","#panel_"+b.id),$(".tabdropdownfileslist li[data-tab-id='"+c+"']").attr("data-tab-id",b.id).data("tab-id",b.id).find(">span").html(b.name),$("div.ui-tabs-panel[data-tab-id='"+c+"']").attr("id","panel_"+b.id).attr("data-tab-id",b.id).data("tab-id",b.id).find("div.ace_editor").attr("id","editor_"+b.id);for(var g=0;g<=editors.length-1;g++)if(editors[g].id==c){editors[g].id=b.id;break}this.updateOpenState(d,c)},generateIdFromURL:function(a){return a.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase()},openWelcome:function(){var a="editor/welcome";this.open({id:this.generateIdFromURL(a),url:a,title:"Welcome",type:this.Types.WELCOME})},openSystem:function(a){"undefined"!=typeof a.id&&null!=a.id||(a.id=this.generateIdFromURL(a.url)),a.type=this.Types.SYSTEM,a.url.indexOf("database/connect")>-1&&(a.isDatabase=!0),this.open(a)},openRemoteSystem:function(a,b){a.isRemote=!0,a.remoteInfo=b,this.openSystem(a)},openFile:function(a){var b={id:a.id,url:a.url,title:a.name};b.isNew=""==a.url,b.isRemote="undefined"!=typeof a.isRemote&&a.isRemote,b.type=!b.isNew&&base.isImage(a.url)?this.Types.IMAGE:this.Types.EDITOR,"undefined"!=typeof a.content&&a.content&&(b.content=a.content),this.open(b)},openRemoteFile:function(a,b){var c={id:a.id,url:a.url,title:a.name,remoteInfo:b};c.isNew=!1,c.isRemote=!0,c.type=!c.isNew&&base.isImage(a.url)?this.Types.IMAGE:this.Types.EDITOR,this.open(c)},open:function(a){if("undefined"==typeof a.isActive?a.isActive=!0:a.isActive&&(a.isActive=base.stringToBoolean(a.isActive)),a)return $(base.options.configAce.tabListUl).find("li#panel_nav_"+a.id).length>0?(a.isActive&&!$(base.options.configAce.tabListUl).find("li#panel_nav_"+a.id).hasClass("ui-tabs-active")&&this.activate(a.id),!1):("undefined"!=typeof a.isNew&&"string"==typeof a.isNew&&(a.isNew=base.stringToBoolean(a.isNew)),"undefined"!=typeof a.isRemote&&"string"==typeof a.isRemote&&(a.isRemote=base.stringToBoolean(a.isRemote)),a.type!=this.Types.EDITOR||a.isNew||base.getModeExtension(base.getExtension(a.url))?void this.__add(a):void $.notify("Invalid file.","error"))},__add:function(a){this.__addTab(a),(a.isNew||"undefined"!=typeof a.content&&null!==a.content||!a.isActive&&!base.stringToBoolean(base.options.configAce.lazyloading))&&this.load(a),this.isProcessingMultipleTabs()||a.type==this.Types.WELCOME||a.type==this.Types.EDITOR&&a.isNew||this.saveOpenState(a),a.isActive&&this.activate(a.id)},__addTab:function(a){var b=this.getInstance().widget(),c=a.url?base.workspace.getNamedURL(a.url):a.title,d=$('<li class="unselected unsaved"><div class="tabbttn"><span class="name"><a href="#panel_'+a.id+'" title="'+c+'">'+a.title+"</a></span></div></li>").attr("id","panel_nav_"+a.id).attr("data-tab-id",a.id).attr("data-tab-url",a.url).data("tab-data",a).append('<a href="#" class="close"></a>').appendTo(b.find(".ui-tabs-nav")),e=$('<div id="panel_'+a.id+'" data-tab-id="'+a.id+'"><!-- New editor: '+a.id+": <br/> --></div>");return b.append(e),a.type!=this.Types.WELCOME&&this.__addToDropdown(a),this.refreshWidget(),d},__addEditor:function(a,b,c){"undefined"!=typeof c&&null!=c||(c="");var d=$('<div id="editor_'+b.id+'" class="ace_editor">'+c+"</div>");a.append(d);var e=ace.edit("editor_"+b.id);ace.require("ace/ext/language_tools"),""!=base.options.configAce.setTheme&&e.setTheme("ace/theme/"+base.options.configAce.setTheme);var f=base.getModeExtension(base.getExtension(b.title));base.stringToBoolean(base.options.configAce.autoSetMode)&&""!=f?e.getSession().setMode("ace/mode/"+f):e.getSession().setMode("ace/mode/"+base.options.configAce.setMode),e.gotoLine(1),e.selection.getCursor(),e.session.getLength(),e.getSession().setTabSize(parseInt(base.options.configAce.setTabSize)),e.getSession().setUseWrapMode(base.options.configAce.setUseWrapMode),document.getElementById("editor_"+b.id).style.fontSize=base.options.configAce.fontSize,e.setShowPrintMargin(base.stringToBoolean(base.options.configAce.setShowPrintMargin)),e.setReadOnly(base.stringToBoolean(base.options.configAce.setReadOnly)),e.renderer.setShowGutter(base.options.configAce.showGutter),e.getSession().setUseSoftTabs(base.options.configAce.useSoftTab),e.setHighlightSelectedWord(base.options.configAce.highlightSelectedWord),e.setFadeFoldWidgets(base.options.configAce.fadeFoldWidgets),""!=base.options.configAce.folding&&e.getSession().setFoldStyle(base.options.configAce.folding),e.setHighlightActiveLine(base.options.configAce.highlightActiveLine),e.setDisplayIndentGuides(base.options.configAce.showIndentGuides),e.setShowInvisibles(base.options.configAce.showInvisibles),e.setBehavioursEnabled(base.options.configAce.enableBehaviors),e.setAnimatedScroll(base.options.configAce.animatedScroll),e.setAutoScrollEditorIntoView(),e.renderer.setScrollMargin(0,0),e.setOptions(base.options.configAce.setOptions);var g={ace:null,vim:require("ace/keyboard/vim").handler,emacs:"ace/keyboard/emacs"};e.setKeyboardHandler(g[base.options.configAce.keyBinding]),e.on("change",function(a){base.tab.markChanged()}),e.on("cut",function(a,b){clipboard=b.session.getTextRange(a)}),e.on("copy",function(a){clipboard=a}),e.getSession().selection.on("changeSelection",base.onSelectionChange),e.getSession().selection.on("changeCursor",base.onCursorChange),e.resize(),e.commands.bindKey("Ctrl-F",null),e.commands.bindKey("Command-F",null),editors.push({id:b.id,instance:e})},__addImage:function(a,b){var c=$('<div id="editor_'+b.id+'" class="ace_editor"><iframe class="imagetabframe" id="frame'+b.id+'" src="'+base.options.baseUrl+"image/load/?image="+unescape(b.url)+'"/></div><div class="clear"></div>'),d=c.find("iframe").get(0);base.key.hook(d.contentWindow||d.contentDocument),a.append(c),files.push({id:b.id})},__addStatic:function(newTabPanelElement,e){var newEditorElement=$('<div id="editor_'+e.id+'" class="ace_editor '+(e.type?e.type+"_tab":"")+" "+(e.isRemote?e.remoteInfo.type+"_tab":"")+'"><iframe class="tabframe'+(e.isDatabase?" databasetabframe":"")+'" id="frame'+e.id+'" src="'+e.url+"?"+(new Date).getTime()+'"/></div><div class="clear"></div>');newTabPanelElement.append(newEditorElement),files.push({id:e.id}),$("#frame"+e.id).load(function(){if(base.key.hook(this.contentWindow||this.contentDocument),!($(this).closest(".ace_editor").find(">.infopopupcontrols").length>0)){var frame_id=$(this).attr("id");$(this).contents().find("body").removeAttr("style");var _controls=$(this).contents().find("body").data("controls");if("undefined"!=typeof _controls){var controlls='<div class="clear"></div><div class="infopopupcontrols ontab"><div class="infopopupcontrolsinside">',_Obj=eval("["+_controls+"]");_Obj=_Obj.hasOwnProperty(0)?_Obj[0]:{},$.each(_Obj,function(a,b){_Obj[a];controlls=controlls+'<input type="submit" data-fram-id="'+frame_id+'"  data-action="'+_Obj[a]+'" class="button save tabsButton" value="'+a+'" name="save" />'}),controlls+='<div class="clear"></div></div><div class="clear"></div></div><div class="clear"></div>',$(this).parents(".ace_editor").append(controlls)}}})},activate:function(a){"object"!=typeof a&&(a=base.tab.get(a)),this.getInstance().option("active",this.getInstance().widget().find(".ui-tabs-nav li").index(a))},load:function(a,b){var c=this.get(a.id);this.startLoading(c);var d=$("#panel_"+a.id,this.getInstance().widget());if(a.type==this.Types.EDITOR){if(!a.isNew&&("undefined"==typeof a.content||null===a.content))return void $.get(base.options.baseUrl+"file/get?path="+unescape(a.url),function(e){base.tab.__addEditor(d,a,e),"undefined"!=typeof b&&b&&b(),base.tab.stopLoading(c)});this.__addEditor(d,a,a.content)}else a.type==this.Types.IMAGE?this.__addImage(d,a):this.__addStatic(d,a);this.stopLoading(c)},startLoading:function(a){a.removeClass("loaded").addClass("loading"),a.append("<span class='loader'><i class='fa fa-spin fa-spinner'></i></span>")},stopLoading:function(a){a.find(".loader").remove(),a.removeClass("loading").addClass("loaded")},refreshFile:function(a){return base.file.isChanged(a)?void $.alert.open({type:"confirm",content:"The file has been changed. The changes you have made will be lost if you refresh the file. Are you sure you want to continue?",buttons:{yes:"Yes",no:"No"},callback:function(b){if("yes"==b)base.tab.__refreshFile(a);else{var c=base.getEditorInstance(a);if(!c)return;c=c.instance,c.focus()}}}):this.__refreshFile(a)},__refreshFile:function(a){"object"!=typeof a&&(a=this.get(a));var b=a.data("tab-data");return this.startLoading(a),b.isRemote?base.ftp.__refreshRemoteFile(b,function(){$.get(base.options.baseUrl+"file/get?path="+unescape(b.url),function(b){base.tab.__refreshedFile(a,b)})}):void $.get(base.options.baseUrl+"file/get?path="+unescape(b.url),function(b){base.tab.__refreshedFile(a,b)})},__refreshedFile:function(a,b){var c=a.data("tab-data"),d=base.getEditorInstance(c.id);d&&(d=d.instance,d.setValue($("<div>"+b+"</div>").text(),-1),base.tab.markUnchanged(a),d.focus(),base.tab.stopLoading(a))},closeActive:function(){this.close(this.getActive())},close:function(tab){"object"!=typeof tab&&(tab=base.tab.get(tab));var data=tab.data("tab-data"),id=data.id,editor=base.getEditorInstance(id);if("undefined"!=typeof editor){var editor=editor.instance;editors.splice(editor.index,1),editor.destroy()}tab.remove(),$("div.editortabbar").find("#panel_"+id).remove(),this.__removeFromDropdown(data),data.type==this.Types.WELCOME&&(myLayout.open("west"),myLayout.open("east"),base.request({url:"editor/welcome_action",data:{action:"false"}})),data.isRemote&&(data.type==this.Types.EDITOR||data.type==this.Types.IMAGE?base.ftp.deleteRemoteTempFile(data.id):data.type==this.Types.SYSTEM&&base.ftp.disconnect(data.remoteInfo.connection)),this.isProcessingMultipleTabs()||(this.refreshWidget(),data.isRemote||data.type==this.Types.EDITOR&&data.isNew||this.removeOpenState(id,function(e){var _obj=eval(e);if(_obj&&_obj.hasOwnProperty("id")){var add=!0;if($("ul.dropdownrecent li").each(function(){var a=$(this).find("a").attr("data-tab-id");a==_obj.id&&(add=!1)}),add){var _options='<li class="child"><a href="javascript:void(0)" data-action="openRecentFile" data-action-type="calljs" data-tab-id="'+_obj.id+"\" data-tab-data='"+JSON.stringify(_obj)+"'><span>"+_obj.title+"</span></a></li>";$(".dropdownrecent").prepend(_options)}}}),base.prepareStage(),base.disableMenus())},__addToDropdown:function(a){var b=$(".tabdropdownfileslist"),c=$("li.tabfileitem",b).length,d=$("li.tabsystemitem",b).length,e=$("li.navsep",b),f=$("<li data-tab-id='"+a.id+"'><span>"+a.title+"</span></li>").appendTo(b);a.type!=this.Types.SYSTEM?(e.length>0?f.insertBefore(e):c>0?(f.appendTo(b),$("li.tabfileitem.last",b).removeClass("last"),f.addClass("last")):(f.prependTo(b),d>0&&(e=$("<li class='navsep'><span></span></li>").insertAfter(f),$("li.tabsystemitem.first",b).removeClass("first")),f.addClass("first")),f.addClass("tabfileitem")):(f.appendTo(b),d>0?$("li.last",b).removeClass("last"):c>0?e=$("<li class='navsep'><span></span></li>").insertBefore(f):f.addClass("first"),f.addClass("tabsystemitem"),f.hasClass("first")||f.addClass("last"))},__removeFromDropdown:function(a){var b=$(".tabdropdownfileslist");$("li[data-tab-id='"+a.id+"']",b).remove();var c=$("li.tabfileitem",b),d=$("li.tabsystemitem",b),e=c.length,f=d.length,g=$("li.navsep",b);if((e<=0||f<=0)&&g.length>0&&g.remove(),!(e<=0&&f<=0)){if(e>0){var h=$(c.get(0));if(h.hasClass("first")||h.removeClass("last").addClass("first"),e>1&&f<=0){var i=$(c.get(e-1));i.hasClass("last")||i.addClass("last")}}if(f>0){if(f>1||e>0){var i=$(d.get(f-1));i.hasClass("last")||i.addClass("last")}if(e<=0){var h=$(d.get(0));h.hasClass("first")||h.removeClass("last").addClass("first")}}}},__isProcessingMultipleTabs:!1,isProcessingMultipleTabs:function(){return this.__isProcessingMultipleTabs},startProcessingMultipleTabs:function(){this.__isProcessingMultipleTabs=!0},stopProcessingMultipleTabs:function(a){"undefined"==typeof a&&(a=!0),this.__isProcessingMultipleTabs=!1,a&&this.saveAllOpenState(),this.refreshWidget()},saveOpenState:function(a,b){return!a.isRemote&&($.post(base.options.baseUrl+"editor/addactivity",{activity:a},function(a){"undefined"!=typeof b&&b(a)}),!0)},removeOpenState:function(a,b){return $.post(base.options.baseUrl+"editor/deleteactivity",{id:a},function(a){"undefined"!=typeof b&&b(a)}),!0},updateOpenState:function(a,b){return!a.isRemote&&void $.post(base.options.baseUrl+"editor/updateactivity",{activity:a,id:b})},saveAllOpenState:function(a){var b=[];this.getInstance().widget().find(".ui-tabs-nav>li").each(function(){var a=$(this).data("tab-data");a.isNew||a.isRemote||b.push(a)}),b.length<=0||$.post(base.options.baseUrl+"editor/saveTabs",{tabs:b},function(b){"undefined"!=typeof a&&a(b)})}}}(),base.loadWorkshop=function(){base.workspace.reload()},base.loadDatabases=function(){base.database.reload()},base.disableMenus=function(a){base.tab.hasChanged(base.tab.getActiveId())?base.command.enable("saveFile"):base.command.disable("saveFile"),editors.length>0?base.command.enable("saveAs"):base.command.disable("saveAs");var b=$("#editorfilelist li a.ui-tabs-anchor span");b.length>0?base.command.enable("saveAll"):base.command.disable("saveAll");var b=$("#editorfilelist li");if(b.length>0?(base.command.enable("closeFile"),base.command.enable("closeAll")):(base.command.disable("closeFile"),base.command.disable("closeAll")),base.workspace.isSandboxAvailable()){base.command.enable("previewCurrentWorkspace");var c=base.tab.getActiveId();""==c||"undefined"==typeof base.getEditorInstance(c)||base.tab.isNewFile(c)?base.command.disable("previewActiveTab"):base.command.enable("previewActiveTab")}else base.command.disable("previewCurrentWorkspace"),base.command.disable("previewActiveTab");base.file.isSelected()&&!base.file.isRootSelected()?base.file.isZipSelected()?(base.command.disable("compress"),base.command.disable("compressAs"),base.command.enable("extract"),base.command.enable("extractInto")):(base.command.enable("compress"),base.command.enable("compressAs"),base.command.disable("extract"),base.command.disable("extractInto")):(base.command.disable("compress"),base.command.disable("compressAs"),base.command.disable("extract"),base.command.disable("extractInto"))},base.welcome=function(){base.tab.openWelcome()},base.initActivity=function(){$('<iframe id="activityinitializer" src="'+base.options.baseUrl+'editor/getactivity/" style="display: none;" />').appendTo("body").on("load",function(n){var elmnts=$(this).contents().find("html:first").find("body:first").html();if($("iframe#activityinitializer").remove(),""!=elmnts){var json=eval("("+elmnts+")"),array=[];if(null===json)return base.stringToBoolean(base.options.configAce.enableWelcome)&&base.tab.openWelcome(),base.finished(),!1;$.each(json,function(a,b){array.push(new Array(a,b))});var len="undefined"!=typeof array.length?array.length:0,cIndex=0;base.tab.startProcessingMultipleTabs(),base.initActivity.initializing=function(){cIndex<len?(base.tab.open(array[cIndex][1]),$("#"+array[cIndex][0]).prop("checked",!0),timer=setTimeout(function(){base.initActivity.initializing()},500)):(clearTimeout(timer),base.finished(),base.tab.stopProcessingMultipleTabs(!1)),cIndex++},base.stringToBoolean(base.options.configAce.enableWelcome)?(base.tab.openWelcome(),timer=setTimeout(function(){base.initActivity.initializing()},500)):base.initActivity.initializing()}})},base.finished=function(){base.prepareStage(),$(".initialize").delay(1e3).fadeOut(500,function(){$(".initialize").remove()})},base.popup=function(a){var b="undefined"!=typeof a.data("action")&&""!=a.data("action")?a.data("action"):a.data("file-url");$("#popupHandle").attr("href",b),$("#popupHandle.scpopuplink").data("title",a.data("title")),$("#popupHandle").trigger("click")},base.openPopup=function(e){var modal="undefined"==typeof e.modaless||!e.modaless,id=base.tab.generateIdFromURL(e.url.replace(/\?[^.]*/g,"")),popupEle=$("#popup"+id);if(popupEle.length<=0){var url=base.options.baseUrl+e.url;url+=(url.indexOf("?")>-1?"&":"?")+"t="+(new Date).getTime();var onloadPopup=function(){var iframeWnd=this.contentWindow||this.contentDocument;modal||base.key.hook(iframeWnd),iframeWnd.POPUP_ID=id;var iframeBody=$(this).contents().find("body");iframeBody.data("popup-id",id);var popupEle=$(this).parent(),dlg=popupEle.dialog("instance"),buttons=[],_controls=iframeBody.data("controls");if(_controls){var _Obj=eval("["+_controls+"]");_Obj=_Obj.hasOwnProperty(0)?_Obj[0]:{},$.each(_Obj,function(a,b){buttons[buttons.length]={text:a,click:function(){var a=$(this).find("iframe").get(0),c=a.contentWindow||a.contentDocument,d=c[b];return"undefined"==typeof d?void console.warn(b+" is not defined in the popup."):void d()}}})}dlg.option("buttons",buttons);var _h=iframeBody.data("height"),_w=iframeBody.data("width");_w="undefined"!=typeof _w?parseFloat(_w):iframeBody[0].scrollWidth,_h="undefined"!=typeof _h?parseFloat(_h):iframeBody[0].scrollHeight,dlg.widget().css({opacity:1}),dlg.option({width:_w+20+26,height:_h+10+26+35,position:{my:"center center",at:"center center",of:"body"}})};$("<div class='popup' id='popup"+id+"' data-popup-id='"+id+"'></div>").append($("<iframe>",{id:"popupcontent"+id,src:url,load:onloadPopup})).dialog({appendTo:"body",closeOnEscape:!0,
title:e.title,modal:modal,width:"auto",height:"auto",maxWidth:$("body").width(),maxHeight:$("body").height(),close:function(a,b){$(this).dialog("instance").destroy(),base.popupId=null}})}else popupEle.dialog("instance").open()},base.closePopup=function(a){if("undefined"==typeof a&&(a=base.popupId),a){var b=$("#popup"+a).dialog("instance");b&&b.destroy(),base.popupId=null}},base.notify=function(){var a=base.thisEl;$.notify(a.msg,a.type)},base.onCursorChange=function(){if(""!=base.options.configAce.folding&&"manual"!=base.options.configAce.folding&&"active"==base.options.configAce.statusBar&&"active"==base.options.configAce.tagBar){if(""==base.tab.getActiveId()||"undefined"==typeof base.getEditorInstance(base.tab.getActiveId()))return;var a=base.getEditorInstance(base.tab.getActiveId()).instance,b=a.session.selection.getSelectionAnchor();if(b.column>0){for(var c=b.column-1,d=a.session.getLine(b.row);c<d.length-1;){var e=d.substr(c,1);if(" "==e||"<"==e||">"==e)break;c++}b.column=c}for(var f=[],g={start:{row:b.row,column:0},end:b};g;){for(var h=a.session.getTextRange(g),i=h.trim(),j=i.split(/[\s>]/),k=[],l=0,m=0;m<j.length;m++){for(;k.length>0&&k[k.length-1].hasClosingTag;)k.splice(k.length-1);var n=j[m];if(n&&""!=n){var o=n.indexOf("<");if(o!=-1&&(o>0&&(n=n.substr(o)),"<?"!=n.substr(0,2))){n=n.substr(1);var p=h.indexOf(n);if(h=h.substr(p+n.length+1),l+=p,0==n.indexOf("/"))k.length>0&&k[k.length-1].name==n.substr(1)&&(k[k.length-1].hasClosingTag=!0);else{var q={name:n,range:{start:{row:g.start.row,column:l},end:{row:g.start.row,column:l+n.length}},hasClosingTag:!1};k.push(q)}l+=n.length+1}}}for(var m=k.length-1;m>=0;m--)f.unshift(k[m]);(g=a.session.getParentFoldRangeData(g.start.row).range)&&(g={start:{row:g.start.row,column:0},end:{row:g.start.row,column:a.session.getLine(g.start.row).length-1}})}for(var r=$("#statusbar #tagbar").empty().hide(),m=0,q=null;q=f[m++];)$("<span />").addClass("spathtag"+(0==m?" first":"")+(m==f.length-1?" last":"")).html("&lt;"+q.name+"&gt;").data("range",q.range).appendTo(r);r.show()}base.onSelectionChange()},base.onSelectionChange=function(){if(""!=base.tab.getActiveId()&&"undefined"!=typeof base.getEditorInstance(base.tab.getActiveId())){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b=a.session.selection.getSelectionAnchor(),c=base.getEditorMode(base.getExtension(base.getFileName(base.tab.getActiveId()))),d=a.session.getTextRange(a.getSelectionRange()).length,e=base.formatSizeUnits(d)+" Ln: "+b.row+" Col: "+b.column+" - "+c;$("#statusbar .linecolformat").html(e);var f="editor/search",g=base.tab.generateIdFromURL(f),h=$("#popupcontent"+g);if(h.length>0){var i=a.selection.getRange(),j=h[0].contentWindow||h[0].contentDocument;j.enableReplaceInSelection(i.start.row==i.end.row&&i.start.column==i.end.column)}}},base.getEditorMode=function(a){return base.editorModeAndFileNameMaping().hasOwnProperty(a)?base.editorModeAndFileNameMaping()[a]:a},base.editorModeAndFileNameMaping=function(){var a={appcache:"Plain Text",as:"Action Script",ascx:"ASP.NET",ashx:"ASP.NET",asmx:"ASP.NET",aspx:"ASP.NET",asx:"ASP.NET",axd:"ASP.NET",c:"C Source",cc:"C++",cl:"Common Lisp",class:"Java",clj:"Clojure",cmx:"OCaml",cmxa:"OCaml",coffee:"CoffeeScript",config:"Plain Text",cpp:"C++",crt:"CRT",cs:"C#",csh:"C Shell Script",css:"CSS",csv:"CSV",cxx:"C++",d:"D",diff:"diff",dtd:"DTD",dylan:"Dylan",e:"Eiffel",ecl:"ECL",ejs:"Embedded JavaScript",engine:"Plain Text",f:"Fortran",f2k:"Fortran",f90:"Fortran",f95:"Fortran",feature:"Gherkin",for:"Fortran",fs:"F#",fsi:"F#",fsscript:"F#",fsx:"F#",gas:"Gas",go:"Go",groovy:"Groovy",gsh:"Groovy",gvy:"Groovy",gy:"Groovy",h:"C++",haml:"HAML",hs:"Haskell",htaccess:"HTACCESS",htm:"HTML",html:"HTML",hx:"Haskell",hxx:"C++",inc:"PHP",ini:"Plain Text",install:"Plain Text",jade:"Jade",jar:"Java Archive",java:"Java Source",jl:"Julia",js:"JavaScript",jsp:"Java Server Pages",json:"JSON",jsonld:"JSON-LD",kt:"Kotlin",las:"Haskell",less:"LESS",lhs:"Haskell",lisp:"Common Lisp",litcoffee:"CoffeeScript",latex:"LaTex",ls:"LiveScript",ltx:"LaTex",lua:"Lua",m:"Octave",master:".NET",md:"Markdown",markdown:"Markdown",ml:"OCaml",mli:"OCaml",mrc:"mIRC",nt:"NTriples",pas:"Pascal",pascal:"Pascal",php:"PHP",php3:"PHP",php4:"PHP",phtml:"PHP",pig:"Pig",pl:"Perl",pp:"Puppet",profile:"Plain Text",properties:"Properties File",py:"Python",r:"R",rb:"Ruby",rest:"reStructuredText",restx:"reStructuredText",rs:"Rust",rst:"reStructuredText",sass:"SASS",scala:"Scala",scm:"Scheme",script:"Plain Text",scss:"SCSS",sh:"Shell",sieve:"Sieve",slim:"Slim",smd:"Scheme",sql:"SQL",ss:"Scheme",st:"Smalltalk",sv:"SystemVerilog",svh:"Verilog","svn-base":"Plain Text",tcl:"Tcl",test:"Plain Text",tex:"LaTex",tmpl:"Plain Text",tpl:"SmartyMixed",ts:"TypeScript",txt:"Plain Text",v:"Verilog",vb:"VB.NET",vbs:"VBScript",vh:"Verilog",vm:"Velocity",xhtml:"HTML",xml:"XML",xq:"XQuery",xql:"XQuery",xqm:"XQuery",xquery:"XQuery",xqws:"XQuery",xqy:"XQuery",xsl:"XML",xslt:"XML",yaml:"YAML",yml:"YAML",z80:"Z80"};return a},base.resetConfiguration=function(a){switch($.each(editors,function(b,c){switch(a.key){case"setTabSize":c.instance.getSession().setTabSize(a.value),base.options.configAce.setTabSize=a.value;break;case"setTheme":c.instance.setTheme("ace/theme/"+a.value),base.options.configAce.setTheme=a.value;break;case"setMode":c.instance.getSession().setMode("ace/mode/"+a.value),base.options.configAce.setMode=a.value;break;case"fontSize":$(".ace_editor").css({"font-size":a.value}),base.options.configAce.fontSize=a.value;break;case"setUseWrapMode":c.instance.getSession().setUseWrapMode(base.stringToBoolean(a.value)),base.options.configAce.setUseWrapMode=a.value;break;case"setReadOnly":c.instance.setReadOnly(base.stringToBoolean(a.value)),base.options.configAce.setReadOnly=a.value;break;case"setShowPrintMargin":c.instance.setShowPrintMargin(base.stringToBoolean(a.value)),base.options.configAce.setShowPrintMargin=a.value;break;case"get_autocomplete":c.instance.setOptions({enableBasicAutocompletion:base.stringToBoolean(a.value)}),base.options.configAce.setOptions={enableBasicAutocompletion:base.stringToBoolean(a.value)};break;case"editor_show_indent_guides":c.instance.setDisplayIndentGuides(base.stringToBoolean(a.value));break;case"editor_show_gutter":c.instance.renderer.setShowGutter(base.stringToBoolean(a.value));case"editor_use_soft_tab":c.instance.getSession().setUseSoftTabs(base.stringToBoolean(a.value));case"editor_highlight_selected_word":c.instance.setHighlightSelectedWord(base.stringToBoolean(a.value));case"editor_fade_fold_widgets":c.instance.setFadeFoldWidgets(base.stringToBoolean(a.value));case"editor_scroll_past_end":c.instance.setOption("scrollPastEnd",base.stringToBoolean(a.value));break;case"editor_code_folding":c.instance.getSession().setFoldStyle(a.value);break;case"editor_key_binding":var d={ace:null,vim:require("ace/keyboard/vim").handler,emacs:"ace/keyboard/emacs"};base.options.configAce.keyBinding=a.value,c.instance.setKeyboardHandler(d[base.options.configAce.keyBinding]);break;case"editor_soft_wrap":c.instance.session.setOption("wrap",a.value);break;case"editor_highlight_line":c.instance.setHighlightActiveLine(base.stringToBoolean(a.value));break;case"editor_show_invisibles":c.instance.setShowInvisibles(base.stringToBoolean(a.value));break;case"editor_enable_behaviors":c.instance.setBehavioursEnabled(base.stringToBoolean(a.value));break;case"elastic_tabstops":c.instance.setOption("useElasticTabstops",base.stringToBoolean(a.value));break;case"js_jshint_enable":c.instance.setOption("useWorker",base.stringToBoolean(a.value));break;case"show_token_info":c.instance.setOption("showTokenInfo",base.stringToBoolean(a.value));break;case"editor_selection_style":c.instance.setOption("selectionStyle",a.value);break;case"editor_animated_scroll":c.instance.setAnimatedScroll(base.stringToBoolean(a.value))}}),a.key){case"editor_page_theme":$("[data-default-theme]").each(function(b,c){if("undefined"!=typeof $(this).data("default-theme")&&""!=$(this).data("default-theme"))if("undefined"==typeof $(this).data("src")||""==$(this).data("src")){var d=$(this).attr("href"),e=d.replace($(this).data("default-theme"),a.value);$(this).attr("data-src",d),$(this).attr("href",e)}else{var d=$(this).data("src"),e=d.replace($(this).data("default-theme"),a.value);$(this).attr("href",e)}}),$("iframe").each(function(b,c){$(this).contents().find("[data-default-theme]").each(function(){if("undefined"!=typeof $(this).attr("data-default-theme")&&""!=$(this).attr("data-default-theme"))if("undefined"==typeof $(this).attr("data-src")||""==$(this).attr("data-src")){var b=$(this).attr("href"),c=b.replace($(this).attr("data-default-theme"),a.value);$(this).attr("data-src",b),$(this).attr("href",c)}else{var b=$(this).attr("data-src"),c=b.replace($(this).attr("data-default-theme"),a.value);$(this).attr("href",c)}})});break;case"cancleeditor_page_theme":$("[data-default-theme]").each(function(a,b){"undefined"!=typeof $(this).data("src")&&""!=$(this).data("src")&&$(this).attr("href",$(this).data("src"))}),$("iframe").each(function(a,b){$(this).contents().find("[data-default-theme]").each(function(){"undefined"!=typeof $(this).data("src")&&""!=$(this).data("src")&&$(this).attr("href",$(this).data("src"))})});break;case"statusbar":$("#statusbar").removeClass("active").removeClass("inactive").addClass(a.value),base.options.configAce.statusBar=a.value,base.prepareStage();break;case"tagbar":$("#tagbar").removeClass("active").removeClass("inactive").addClass(a.value),base.options.configAce.tagBar=a.value,base.prepareStage();break;case"toolbar_enable":base.options.configAce.toolbar=1==a.value?"true":"false";break;case"search_collapse":base.options.configAce.search_collapse=1==a.value?"true":"false"}console.log(a)},base.quit=function(){window.location=base.options.baseUrl},base.logOut=function(){window.location=base.options.baseUrl+"guest/logout"},base.stringToBoolean=function(a){switch(a.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(a)}},base.extensionMapping=function(){var a={action:"java",appcache:"plain_text",as:"actionscript",ascx:"dot",ashx:"dot",asmx:"dot",asp:"dot",asx:"dot",aspx:"dot",axd:"dot",bat:"batchfile",btm:"batchfile",c:"c_cpp",cc:"c_cpp",cfm:"coldfusion",cfml:"coldfusion",cl:"plain_text",class:"java",clj:"clojure",cmx:"ocaml",cmxa:"ocaml",coffee:"coffee",config:"plain_text",cpp:"c_cpp",crt:"plain_text",css:"css",cs:"csharp",csh:"plain_text",csv:"plain_text",cxx:"c_cpp",d:"d",diff:"diff",dist:"plain_text",do:"java",dpj:"java",dtd:"plain_text",dylan:"plain_text",e:"eiffel",ecl:"plain_text",ejs:"ejs",engine:"plain_text",erb:"ruby",f:"plain_text",f2k:"plain_text",f90:"plain_text",f95:"plain_text",feature:"gherkin",for:"plain_text",fs:"plain_text",fsi:"plain_text",fsscript:"plain_text",fsx:"plain_text",gas:"plain_text",gitattributes:"plain_text",gitignore:"gitignore",go:"plain_text",groovy:"groovy",gsh:"groovy",gvy:"groovy",gy:"groovy",h:"c_cpp",haml:"haml",hdl:"c_app",hpp:"c_cpp",hs:"haskell",htaccess:"plain_text",htm:"html",html:"html",hx:"haskell",hxx:"c_cpp",inc:"php",ini:"ini",install:"plain_text",jade:"jade",jar:"java",java:"java",jhtml:"html",jar:"java",jl:"julia",js:"javascript",json:"json",jsonld:"plain_text",jsp:"java",jspx:"java",kt:"plain_text",las:"haskell",latex:"latex",less:"less",lock:"plain_text",ltx:"latex",lhs:"haskell",lisp:"lisp",litcoffee:"coffee",log:"plain_text",ls:"livescript",lua:"lua",m:"objectivec",master:"csharp",md:"markdown",markdown:"markdown",ml:"ocaml",mli:"ocaml",module:"plain_text",mrc:"plain_text",nt:"plain_text",pas:"pascal",pascal:"pascal",php:"php",php3:"php",php4:"php",phtml:"php",pig:"plain_text",pl:"perl",pot:"plain_text",pp:"plain_text",profile:"plain_text",properties:"properties",py:"python",pm:"perl",r:"r",rb:"ruby",rest:"plain_text",restx:"plain_text",rhtml:"ruby",rjs:"ruby",rs:"rust",rss:"xml",rst:"plain_text",sass:"sass",scala:"scala",script:"plain_text",scss:"scss",sh:"sh",sieve:"plain_text",slim:"plain_text",smd:"scheme",smf:"matlab",sms:"matlab",sql:"mysql",ss:"scheme",st:"plain_text",sv:"verilog",svg:"svg",svh:"verilog","svn-base":"plain_text",tcl:"tcl",tex:"latex",test:"plain_text",tmpl:"plain_text",tpl:"smarty",ts:"typescript",txt:"plain_text",twig:"plain_text",xhtml:"html",xml:"xml",xq:"xquery",xql:"xquery",xqm:"xquery",xquery:"xquery",xqws:"xquery",xqy:"xquery",xrb:"xml",xsl:"xml",xslt:"xml",v:"verilog",vb:"vbscript",vbs:"vbScript",vh:"verilog",vm:"velocity",wss:"java",yaml:"yaml",yml:"yaml",yaws:"erlang",z80:"plain_text"};return a},base.undefined=function(){alert("Sorry this method is not available in this theme.")},base.generateUniqueId=function(){return(new Date).getTime()+Math.floor(1e4*Math.random())},base.htmlentities=function(a){return jQuery("<div />").text(a).html().replace(/\\/g,"")},base.prepareStage=function(){$("#statusbar").removeAttr("class").addClass(base.options.configAce.statusBar),$("#tagbar").empty().removeClass("active inactive").addClass(base.options.configAce.tagBar),$(".editortoolbarheader").removeClass("inactive"),base.stringToBoolean(base.options.configAce.toolbar)||$(".editortoolbarheader").addClass("inactive"),(base.tab.getCount()<=0||!base.tab.getActiveId()||!base.tab.isEditor(base.tab.getActiveId()))&&($("#statusbar").removeAttr("class").addClass("inactive"),$(".editortoolbarheader").addClass("inactive"));var a=0;$(".footertoolbar").is(":visible")&&(a=$(".footertoolbar").height());var b=0;base.flagFull||(b=$(".headertoolbar").height()+4);var c=$(".editortabbar").height(),d=$(window).height()-(a+b+c),e=0;$(".headertoolbar").is(":visible")&&(e=$("#statusbar").height());var f=0;if($(".editortoolbarheader").is(":visible")&&(f=$(".editortoolbarheader").height()),$(".ace_editor").each(function(){$(this).css({height:d-(e+f)+"px","margin-top":f+"px"})}),$.each(editors,function(a,b){b.instance.resize()}),$("ul.tabdropdownfileslist>li").length>0){var g=$("ul#editorfilelist"),h=g.parent().width(),i=0,j=$(">li",g);if(j.length>0&&j.each(function(){i+=$(this).width()}),h<i){var k=$(">li.ui-tabs-active",g);if(k.length>0){var l=k.position().left,m=l+k.width(),n=g.position().left;l+n<0?n=-l:m+n>h&&(n=h-m),n<0&&i>h&&h-i>n?n=h-i:i<=h&&(n=0),g.css("left",n+"px")}$(".tabcontrolarrow.arrowleft, .tabcontrolarrow.arrowright").show()}else g.css("left","0"),$(".tabcontrolarrow.arrowleft, .tabcontrolarrow.arrowright").hide();$(".tabcontrolarrow.arrowdown").show()}else $(".tabcontrolarrow.arrowleft, .tabcontrolarrow.arrowright, .tabcontrolarrow.arrowdown").hide();base.onSelectionChange()},base.getOpenIn=function(a){if("undefined"!=typeof a&&""!=a.toString()){var b=a.toString().split("-");return"undefined"!=typeof b[1]?b[1]:"editor"}},base.isEdited=function(a){return $(base.options.configAce.tabListUl+">li#panel_nav_"+a).find("a.ui-tabs-anchor span")},base.openRecentFile=function(){var a=$(base.thisEl),b=a.data("tab-data");base.tab.open(b)},base.getEditorInstance=function(a){for(var b=0;b<=editors.length-1;b++)if(editors[b].id==a)return{instance:editors[b].instance,index:b}},base.newFromTemplatePopup=function(){},base.saveAsPopup=function(){},base.findPopup=function(){},base.replacePopup=function(){},base.findInFilesPopup=function(){},base.goToFilePopup=function(){},base.goToLinePopup=function(){},base.keyboardShortcutsPopup=function(){},base.changeLogPopup=function(){},base.aboutPopup=function(){},base.getFileName=function(a){return $.trim($(base.options.configAce.tabListUl+">li#panel_nav_"+a).find("a.ui-tabs-anchor").html().replace(/<span.*?>.*?<\/span>/m,""))},base.selectFile=function(a){return base.file.select(a)},base.getSelectedFile=function(){return base.file.getAllSelected()},base.deselectFile=function(){return base.file.deselect()},base.newFile=function(a){base.file._new(a)},base.fileNewFromContext=function(a,b){base.file._newFromContext(a,b)},base.fileDelete=function(){base.file._delete()},base.dirNew=function(a){base.file._newDir(a)},base.flagFull=!1,base.fullScreen=function(){launchFullscreen($("#mainContent")[0])},document.addEventListener("fullscreenchange",function(){base.onFullscreenChange(document.fullscreenElement)},!1),document.addEventListener("msfullscreenchange",function(){base.onFullscreenChange(document.msFullscreenElement)},!1),document.addEventListener("mozfullscreenchange",function(){console.log("here: "+document.mozFullScreen),base.onFullscreenChange(document.mozFullScreen)},!1),document.addEventListener("webkitfullscreenchange",function(){base.onFullscreenChange(document.webkitIsFullScreen)},!1),base.onFullscreenChange=function(a){this.flagFull=a,this.flagFull?$("#mainContent").addClass("fullscreen"):$("#mainContent").removeClass("fullscreen"),base.prepareStage()},base.fileHasBeenOpened=function(){var a=$("#openner").val(),b=document.getElementById("openner").files;if(!b.length)return void alert("Please select a file.");var c=b[0],d=0,e=c.size-1,f=new FileReader;f.onloadend=function(b){if(b.target.readyState==FileReader.DONE){var c=a.split("/").pop().split("\\").pop();base.openFile({id:base.generateUniqueId(),name:c,content:base.htmlentities(b.target.result)})}};var g=c.slice(d,e+1);f.readAsBinaryString(g),$("#openner").val("")},base.fileOpen=function(){$("#openner").click()},base.saveFile=function(){editors.length>0&&base.file.save(base.tab.getActiveId())},base.saveAll=function(){base.file.saveAll()},base.closeFile=function(){base.file.close(base.tab.getActiveId())},base.getModeExtension=function(a){return base.extensionMapping().hasOwnProperty(a)?base.extensionMapping()[a]:""},base.getExtension=function(a){return base.file.getExtension(a)},base.closeAll=function(){$('[data-action="closeAllFiles"]').parent().hasClass("disable")||base.file.closeAll()},base.toggleLineComment=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;active_editor=a.commands,active_editor.exec("togglecomment",a)},base.lineComment=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b=a.getSelectionRange().start.row,c=a.session.getLine(b);a.find(c),a.replace("//"+c)},base.lineUncomment=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.findPrevious("//"),a.replace("")},base.blockComment=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;if(a.getSelectionRange().start.row==a.getSelectionRange().end.row){var b=a.getSelectionRange().start.row,c=a.session.getLine(b);a.find(c),a.replace("/*"+c+"*/")}else{a.find(a.session.getTextRange(a.getSelectionRange()));var d=a.session.getTextRange(a.getSelectionRange());a.replace("/*"+d+"*/")}},base.blockUncomment=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.findPrevious("/*"),a.replace(""),a.find("*/"),a.replace("")},base.toUpperCase=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.find(a.session.getTextRange(a.getSelectionRange())),a.replace(a.getCopyText().toUpperCase())},base.toLowerCase=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.find(a.session.getTextRange(a.getSelectionRange())),a.replace(a.session.getTextRange(a.getSelectionRange()).toLowerCase())},base.showAutocomplete=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;base.options.configAce.setOptions.enableBasicAutocompletion=!base.options.configAce.setOptions.enableBasicAutocompletion,a.setOptions({enableBasicAutocompletion:base.options.configAce.setOptions.enableBasicAutocompletion}),$.ajax({type:"POST",url:"editor/configSave",data:"editor_page_theme=get_autocomplete&val="+base.options.configAce.setOptions.enableBasicAutocompletion}).done(function(a){base.options.configAce.autoSetMode=base.options.configAce.setOptions.enableBasicAutocompletion}).error(function(a){alert(a.message)})},base.selectAll=function(){base.getEditorInstance(base.tab.getActiveId()).instance.session.selection.selectAll()},base.replace=function(){base.file.openSearchDialog("replace")},base.find=function(){base.file.openSearchDialog("find")},base.showSearchResults=function(){base.file.showSearchResults()},base.redo=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;active_editor=a.commands,active_editor.exec("redo",a)};var clipboard=null;base.cut=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b=a.session.getTextRange(a.getSelectionRange());b&&(a.remove(a.getSelectionRange()),clipboard=b),a.focus()},base.copy=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b=a.session.getTextRange(a.getSelectionRange());b&&(clipboard=b),a.focus()},base.paste=function(){if(null!==clipboard){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b=a.getSelectionRange();a.session.remove(b),a.session.insert(b.start,clipboard),a.focus()}},base.undo=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;active_editor=a.commands,active_editor.exec("undo",a)},base.indent=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;active_editor=a.commands,active_editor.exec("indent",a)},base.outdent=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;active_editor=a.commands,active_editor.exec("outdent",a)},base.findNext=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.findNext()},base.findPrevious=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.findPrevious()},base.getFileNameWithExt=function(a){var b=unescape(a).split("/");return b[b.length-1]},base.isImage=function(a){var b=unescape(a).split("/"),c=b[b.length-1],d=c.split("."),e=d[d.length-1];return base.options.configAce.imageExtension.indexOf(e)>=0},base.replaceNext=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;$('button[action="replaceAndFindNext"]').click(),a.findNext()},base.gotoLine=function(a){var b=base.getEditorInstance(base.tab.getActiveId()).instance;b.gotoLine(a)},base.getCurrentLine=function(a){var b=base.getEditorInstance(base.tab.getActiveId()).instance;return b.getSelectionRange().start.row+1},base.support=function(){window.open("http://support.scriptsconnect.com","_blank")},base.changeThemeAmbiance=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/ambiance")},base.changeThemeChaos=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/chaos")},base.changeThemeClouds=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/clouds")},base.changeThemeCloudsMidnight=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/clouds_midnight")},base.changeThemeCobalt=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/cobalt")},base.changeThemeEclipse=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/eclipse")},base.changeThemeIdlefingers=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/idle_fingers")},base.changeThemekrTheme=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/kr_theme")},base.changeThemeMerbivore=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/merbivore")},base.changeThemeMerbivoreSoft=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/merbivore_soft")},base.changeThemeMonokai=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/monokai")},base.changeThemeMonoIndustrial=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/mono_industrial")},base.changeThemePastelonDark=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/pastel_on_dark")},base.changeThemeRunnableDark=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/runnable_dark")},base.changeThemeRunnableLight=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/runnable_light")},base.changeThemeSolarizedDark=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/solarized_dark")},base.changeThemeTerminal=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/terminal")},base.changeThemeTomorrowNight=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/tomorrow_night")},base.changeThemeTomorrowNightBlue=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/tomorrow_night_blue")},base.changeThemeTomorrowNightBright=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/tomorrow_night_bright")},base.changeThemeTomorrowNight80s=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/tomorrow_night_eighties")},base.changeThemeTwilight=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/twilight")},base.changeThemeVibrantInk=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/vibrant_ink")},base.changeThemeVisualStudio=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setTheme("ace/theme/visualstudio")},base.pageThemeDark=function(){$.ajax({type:"POST",url:"editor/configSave",data:"editor_page_theme=editor_page_theme&val=dark"}).done(function(a){location.reload()}).error(function(a){alert(a.message)})},base.pageThemeLight=function(){$.ajax({type:"POST",url:"editor/configSave",data:"editor_page_theme=editor_page_theme&val=light"}).done(function(a){location.reload()}).error(function(a){alert(a.message)})},base.pageThemeMystic=function(){$.ajax({type:"POST",url:"editor/configSave",data:"editor_page_theme=editor_page_theme&val=mystic"}).done(function(a){location.reload()}).error(function(a){alert(a.message)})},base.pageThemeSmoke=function(){$.ajax({type:"POST",url:"editor/configSave",data:"editor_page_theme=editor_page_theme&val=smoke"}).done(function(a){location.reload()}).error(function(a){alert(a.message)})},base.replacePrevious=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance;$("#replaceButton").click(),a.findPrevious()},base.replaceAll=function(){base.getEditorInstance(base.tab.getActiveId()).instance;$('button[action="replaceAll"]').click()};var font;base.increaseFontSize=function(){"undefined"==typeof font?(font=base.options.configAce.fontSize,font=font.split("p"),font=font[0],font=parseInt(font)+2):font+=2;var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setFontSize(font+"px")},base.decreaseFontSize=function(){"undefined"==typeof font?(font=base.options.configAce.fontSize,font=font.split("p"),font=font[0],font=parseInt(font)-2):font-=2;var a=base.getEditorInstance(base.tab.getActiveId()).instance;a.setFontSize(font+"px")},base.changeSyntaxJavaScript=function(){for(var a=0;a<=editors.length-1;a++){var b=editors[a].instance;b.getSession().setMode("ace/mode/javascript")}},base.wrapLines=function(){base.options.configAce.setUseWrapMode=!base.options.configAce.setUseWrapMode;for(var a=0;a<=editors.length-1;a++){var b=editors[a].instance;b.getSession().setUseWrapMode(base.options.configAce.setUseWrapMode)}$.ajax({type:"POST",url:"editor/configSave",data:"editor_page_theme=editor_toggle_word_wrapping&val="+base.options.configAce.setUseWrapMode}).done(function(a){base.options.configAce.autoSetMode=!1}).error(function(a){alert(a.message)})},base.wrapToViewport=function(){for(var a=0;a<=editors.length-1;a++){var b=editors[a].instance;b.getSession().setUseWrapMode(!0)}},base.beautifyAll=function(){beautify()},base.beautifySelection=function(){beautify(1)},base.stripWhitespace=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b={};b.needle="  ",a.$search.set(b);a.replaceAll("",b);a.focus()},base.stripWhitespaceSelected=function(){var a=base.getEditorInstance(base.tab.getActiveId()).instance,b={};b.needle="  ",b.replaceInSelection=!0,b.range=a.selection.getRange(),a.$search.set(b);a.replaceAll("",b);a.focus()},base.fileOutputPreview=function(){console.log("Clicked: Preview")},base.formatSizeUnits=function(a){return a>=1e9?a=(a/1e9).toFixed(2)+" GB":a>=1e6?a=(a/1e6).toFixed(2)+" MB":a>=1e3?a=(a/1e3).toFixed(2)+" KB":a>1?a+=" bytes":1==a?a+=" byte":a="",""!=a?"("+a+")":""},base.print=function(){var a=base.getEditorInstance(base.tab.getActiveId());if(!a)return void $.notify("No active documents.","warn");a=a.instance;var b=a.container.style.height,c=$(a.container).parent();$("body").append(a.container),a.container.style.height=a.renderer.layerConfig.maxHeight+"px",a.resize(!0),window.print(),a.container.style.height=b,a.resize(!0),c.append(a.container)},base.refresh=function(){base.tab.refreshFile(base.tab.getActiveId())},base.key=function(){var hook=function(a){$(a).keydown(function(a){if(base.key.keydown(a.keyCode),base.key.process(a,a.keyCode))return a.preventDefault(),a.cancelBubble=!0,!1}),$(a).keyup(function(a){base.key.clear()}),$(a).focus(function(a){base.key.clear()})};hook(window);var mixin=function(a,b){for(var c in b)a[c]=b[c];return a},Keys=function(){var b,c,a={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{Ctrl:1,Alt:2,Option:2,Shift:4,Super:8,Meta:8,Command:8,Cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",107:"+",109:"-",110:".",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}};for(c in a.FUNCTION_KEYS)b=a.FUNCTION_KEYS[c].toLowerCase(),a[b]=parseInt(c,10);for(c in a.PRINTABLE_KEYS)b=a.PRINTABLE_KEYS[c].toLowerCase(),a[b]=parseInt(c,10);return mixin(a,a.MODIFIER_KEYS),mixin(a,a.PRINTABLE_KEYS),mixin(a,a.FUNCTION_KEYS),a.enter=a.return,a.escape=a.esc,a.del=a.delete,a[173]="-",function(){for(var b=["Cmd","Ctrl","Alt","Shift"],c=Math.pow(2,b.length);c--;)a.KEY_MODS[c]=b.filter(function(b){return c&a.KEY_MODS[b]}).join("-")+"-"}(),a.KEY_MODS[0]="",a.KEY_MODS[-1]="input",a}(),os=(navigator.platform.match(/mac|iPad|iPod|iPod touch|iPhone|win|linux/i)||["other"])[0].toLowerCase(),ua=navigator.userAgent,isMac="mac"==os||"ipad"==os||"ipod"==os||"ipod touch"==os||"iphone"==os;isMac?$(".shortcut-key-win").hide():$(".shortcut-key-mac").hide();var isLinux="linux"==os,isIE="Microsoft Internet Explorer"==navigator.appName||navigator.appName.indexOf("MSAppHost")>=0?parseFloat((ua.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((ua.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),isOldIE=isIE&&isIE<9,isGecko=isMozilla=(window.Controllers||window.controllers)&&"Gecko"===window.navigator.product,isOldGecko=isGecko&&parseInt((ua.match(/rv\:(\d+)/)||[])[1],10)<4,isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),isWebKit=parseFloat(ua.split("WebKit/")[1])||void 0,isChrome=parseFloat(ua.split(" Chrome/")[1])||void 0,isAIR=ua.indexOf("AdobeAIR")>=0,isIPad=ua.indexOf("iPad")>=0,isTouchPad=ua.indexOf("TouchPad")>=0,isChromeOS=ua.indexOf(" CrOS ")>=0,ts=0,pressedKeys=null;return{hook:hook,keyCodeToString:function(a){var b=Keys[a];return"string"!=typeof b&&(b=String.fromCharCode(a)),
b},keydown:function(a){null==pressedKeys&&(pressedKeys=[]),pressedKeys[a]=!0},clear:function(){pressedKeys=null},process:function(a,b){var c=this.getModifierHash(a);if(!isMac&&pressedKeys){if((pressedKeys[91]||pressedKeys[92])&&(c|=8),pressedKeys.altGr){if(3==(3&c))return;pressedKeys.altGr=0}if(18===b||17===b){var d="location"in a?a.location:a.keyLocation;if(17===b&&1===d)ts=a.timeStamp;else if(18===b&&3===c&&2===d){var e=-ts;ts=a.timeStamp,e+=ts,e<3&&(pressedKeys.altGr=!0)}}}if(b in Keys.MODIFIER_KEYS){switch(Keys.MODIFIER_KEYS[b]){case"Alt":c=2;break;case"Shift":c=4;break;case"Ctrl":c=1;break;default:c=8}b=-1}if(8&c&&(91===b||93===b)&&(b=-1),!c&&13===b){var d="location"in a?a.location:a.keyLocation;if(3===d)return this.callback(a,c,-b)}return isChromeOS&&8&c?this.callback(a,c,b):!!(c||b in Keys.FUNCTION_KEYS||b in Keys.PRINTABLE_KEYS)&&this.callback(a,c,b)},callback:function(e,hashId,keyCode){if(keyCode==-1)return!1;var key=Keys.KEY_MODS[hashId]+this.keyCodeToString(keyCode),action=this.__actions[key];if(action){if("command"==action.type)return base.command.execute(action.name),!0;if("menu"==action.type)return base.menu.click(action.name),!0;if("calljs"==action.type)try{return eval(action.name+"()"),!0}catch(a){return!1}}return!1},getModifierHash:!isMac||!isOpera||"KeyboardEvent"in window?function(a){return 0|(a.ctrlKey?1:0)|(a.altKey?2:0)|(a.shiftKey?4:0)|(a.metaKey?8:0)}:function(a){return 0|(a.metaKey?1:0)|(a.altKey?2:0)|(a.shiftKey?4:0)|(a.ctrlKey?8:0)},__actions:[],registerAction:function(a,b){"Ctrl-C"!=a&&"Ctrl-V"!=a&&"Ctrl-X"!=a&&(this.__actions[a]=b)},unregisterAction:function(a){delete this.__actions[a]}}}(),base.command=function(){return{init:function(a){this.__commands=[];for(var b=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),c="mac"==b,d=0,e=null;e=a[d++];){var f="Y"==e.status;this.__commands[e.name]={title:e.title,name:e.name,active:f,enabled:f},base.key.registerAction(c?e.shortcut_key_mac:e.shortcut_key,{type:"command",name:e.name}),f||this.disable(e.name)}this.__commands.cut={title:"Cut",name:"cut",active:!0,enabled:!0},this.__commands.copy={title:"Copy",name:"copy",active:!0,enabled:!0},this.__commands.paste={title:"Paste",name:"paste",active:!0,enabled:!0},this.__commands.refresh={title:"Refresh",name:"refresh",active:!0,enabled:!0},this.__commands.print={title:"Print",name:"print",active:!0,enabled:!0}},reload:function(){this.init(base.thisEl)},execute:function(action){if("undefined"==typeof this.__commands[action])return void console.warn("Unimplemented command ("+action+").");if(this.__commands[action].enabled){if("undefined"!=typeof base[action])return eval("base."+action+"()");var title=this.__commands[action].title;switch(action){case"newFromTemplate":base.tab.openSystem({url:"template",title:title});break;case"newFolder":base.openPopup({url:"editor/newfolder",title:title});break;case"openFile":base.openPopup({url:"editor/fileOpen",title:title});break;case"uploadFiles":base.tab.openSystem({url:"file/upload",title:title});break;case"saveAs":base.openPopup({url:"editor/saveas",title:title});break;case"findInFiles":base.openPopup({url:"editor/search?tab=findinfiles",title:title,modaless:!0});break;case"goToFile":base.openPopup({url:"editor/gotofile",title:title});break;case"goToLine":base.openPopup({url:"editor/gotoline",title:title});break;case"showShortcutKeys":base.tab.openSystem({url:"command",title:title});break;case"showChangeLog":base.openPopup({url:"editor/changelog",title:title});break;case"previewCurrentWorkspace":base.workspace.preview();break;case"previewActiveTab":base.file.previewActiveTab();break;case"compress":base.file.compressAllSelected();break;case"compressAs":base.file.openCompressAsDialog();break;case"extract":base.file.extractSelected();break;case"extractInto":base.file.openExtractIntoDialog();break;case"openTerminal":if(!base.workspace.isSandboxAvailable())return void $.notify("Terminal is not available for current active workspace.","error");base.layout.togglePane("terminal")}}},disable:function(a){this.__commands[a].enabled=!1,$("[data-action='"+a+"']").addClass("disabled"),$("ul.sitenavigation a[data-action='"+a+"']").parent().addClass("disable")},enable:function(a){return!!this.__commands[a].active&&(this.__commands[a].enabled=!0,$("[data-action='"+a+"']").removeClass("disabled"),void $("ul.sitenavigation a[data-action='"+a+"']").parent().removeClass("disable"))}}}(),base.menu=function(){var a=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),b="mac"==a;return $("ul.sitenavigation a[data-action]").each(function(){var a=$(this);if("command"!=a.data("action-type")){var c=a.find("span.label_key.shortcut-key-"+(b?"mac":"win")).html();c&&c.length>0&&base.key.registerAction(c,{type:"menu",name:a.data("action")})}}),{click:function(a){var b=$("ul.sitenavigation a[data-action='"+a+"']");this.isActive(b)&&b.click()},isActive:function(a){return!a.parent().hasClass("disable")},enable:function(a){$("ul.sitenavigation a[data-action='"+a+"']").removeClass("disable")},disable:function(a){$("ul.sitenavigation a[data-action='"+a+"']").addClass("disable")}}}(),base.file=function(){var COMMAND_CUT="cut",COMMAND_COPY="copy",COMMAND_DUPLICATE="duplicate";return{init:function(){$(base.options.configTree.treeRootElement).on("dblclick","li.subdir > div.icon.dir",function(){base.file.toggleDir($(this).parent())}),$(base.options.configTree.treeRootElement).on("dblclick","li > div.icon.file",function(){var a=$(this).parent();base.file.open({id:a.data("id"),name:a.find(">div.file > span").html(),url:a.data("url")})}),$(base.options.configTree.treeRootElement).on("mousedown","li > div.icon",function(a){base.file.preselect($(this).parent(),a),3!=a.which&&(base.file.captureMouse(),$(window).bind("mousemove",base.file.move).bind("mouseover",base.file.checkDroppable).bind("mouseout",base.file.checkDroppable).bind("mouseup",base.file.releaseMouse).bind("focus",base.file.releaseMouse).bind("blur",base.file.releaseMouse),base.key.registerAction("Esc",{type:"calljs",name:"base.file.releaseMouse"}))}),$(base.options.configTree.treeRootElement).on("click","li > div.icon",base.file.click),$(base.options.configTree.treeRootElement).on("click","li.subdir > div.subdirarrow",function(){base.file.toggleDir($(this).parent())}),$("ul.itemtoolbaroptions > li.expandall",'[data-manager-id="files_manager_container"]').on("click",function(){base.file.expandAll()}),$("ul.itemtoolbaroptions > li.collapseall",'[data-manager-id="files_manager_container"]').on("click",function(){base.file.collapseAll()}),$("ul.itemtoolbaroptions > li.refresh",'[data-manager-id="files_manager_container"]').on("click",function(){base.file.refresh()}),$("ul.itemtoolbaroptions > li.project-change ul.project-list",'[data-manager-id="files_manager_container"]').on("click",">li.project",function(){base.file.changeProject($(this).data("project-id")),setTimeout(function(){$("ul.itemtoolbaroptions > li.project-change ul.project-list",'[data-manager-id="files_manager_container"]').hide()})}),$("ul.itemtoolbaroptions > li.tool-list ul.toolbaroptionitemlist",'[data-manager-id="files_manager_container"]').on("click",">li",function(){var a=$(this);a.hasClass("refresh")&&base.file.refresh(),setTimeout(function(){$("ul.itemtoolbaroptions > li.tool-list ul.toolbaroptionitemlist",'[data-manager-id="files_manager_container"]').hide()})}),this.reload(),this.reloadProjects()},__mouseCaptured:!1,captureMouse:function(){this.__mouseCaptured=!0},releaseMouse:function(a){base.thisEl=a,setTimeout(function(){$(window).unbind("mousemove",base.file.move).unbind("mouseover",base.file.checkDroppable).unbind("mouseout",base.file.checkDroppable).unbind("mouseup",base.file.releaseMouse).unbind("focus",base.file.releaseMouse).unbind("blur",base.file.releaseMouse),base.key.unregisterAction("Esc"),base.file.stopDragging(),base.file.__readyForDragging=0,base.file.__mouseCaptured=!1})},isMouseCaptured:function(){return this.__mouseCaptured},click:function(a){base.file.isDraggingStarted()||base.file.select($(this).parent(),a)},__preselectedNodeUrl:null,preselect:function(a,b){if(a&&!(a.length<=0))if(a.hasClass("selected")||(base.file.__preselectedNodeUrl=a.data("url"),b&&(b.ctrlKey||b.shiftKey)||$("li.selected",base.options.configTree.treeRootElement).removeClass("selected selected-last")),b&&b.shiftKey){var c=$("li",base.options.configTree.treeRootElement),d=c.index($("li.selected-last",base.options.configTree.treeRootElement)),e=c.index(a);if(d>e){var f=d;d=e,e=f}for(var g=0;g<c.length;g++)g>=d&&g<=e?$(c.get(g)).addClass("selected"):$(c.get(g)).removeClass("selected")}else $("li.selected-last",base.options.configTree.treeRootElement).removeClass("selected-last"),a.addClass("selected selected-last")},select:function(a,b){!a||a.length<=0||(b&&b.ctrlKey&&3!=b.which?a.data("url")!=base.file.__preselectedNodeUrl&&a.removeClass("selected"):b&&b.shiftKey&&3!=b.which||b&&3==b.which&&a.hasClass("selected")||($("li.selected, li.selected-last",base.options.configTree.treeRootElement).removeClass("selected selected-last"),a.addClass("selected selected-last")),base.file.__preselectedNodeUrl=null,base.file.isSelected()&&!base.file.isRootSelected()?base.file.isZipSelected()?(base.command.disable("compress"),base.command.disable("compressAs"),base.command.enable("extract"),base.command.enable("extractInto")):(base.command.enable("compress"),base.command.enable("compressAs"),base.command.disable("extract"),base.command.disable("extractInto")):(base.command.disable("compress"),base.command.disable("compressAs"),base.command.disable("extract"),base.command.disable("extractInto")))},deselect:function(){$("li.selected, li.selected-last",base.options.configTree.treeRootElement).removeClass("selected selected-last")},getByURL:function(a){return $("li[data-url='"+a+"']",base.options.configTree.treeRootElement)},removeByURL:function(a){var b=this.getByURL(a);b.length>0&&b.remove(),base.tab.closeByURL(a)},updateByURL:function(a,b){var c=this.getByURL(a);c.length>0&&c.replaceWith(this.createFileNode(b)),base.tab.updateFileByURL(a,b)},move:function(a){if(base.file.isMouseCaptured()&&!base.file.isDraggingStarted()){if(base.file.__readyForDragging<5)return void base.file.__readyForDragging++;base.file.startDragging(a),base.file.checkDroppable(a),base.file.__readyForDragging=0}return base.file.drag(a),a.preventDefault(),a.stopPropagation(),a.cancelBubble=!0,!1},checkDroppable:function(a){if(a&&a.target){var b="mouseout"==a.type,c=$(a.target),d=c[0].tagName.toLowerCase();if("ul"!=d)if($(".drop-target").removeClass("drop-target"),c.closest(base.options.configTree.treeRootElement).length>0){if("li"!=d&&(c=c.closest("li")),c.hasClass("selected"))return;c.addClass("drop-target"),b?$("body").removeClass("droppable not-droppable"):c.hasClass("subdir")&&base.file.isDroppable(c)?$("body").removeClass("not-droppable").addClass("droppable"):$("body").removeClass("droppable").addClass("not-droppable")}else("mainContent"==c[0].id||c.closest("#mainContent").length>0)&&("mainContent"!=c[0].id&&(c=c.closest("#mainContent")),b?($("body").removeClass("droppable not-droppable droppable-on-editor"),c.removeClass("drop-target")):(base.file.getAllSelected().find(">div.icon.file").length>0?$("body").removeClass("not-droppable").addClass("droppable droppable-on-editor"):$("body").removeClass("droppable").addClass("not-droppable"),c.addClass("drop-target")))}},__dragging:!1,__readyForDragging:0,__draggingObject:null,isDraggingStarted:function(){return this.__dragging},startDragging:function(){var a=$("#file-drag-drop");a.length<=0&&(a=$("<div id='file-drag-drop' class='drag-drop-container'>").appendTo("body"));var b=$("<ul class='filenavlist.filelvl1'>");this.getAllSelected().each(function(){$("<li>").append($(this).find(">div.icon").clone()).appendTo(b).data("clone-url",$(this).data("url"))}),b.appendTo(a),a.show(),this.__draggingObject=a,this.__dragging=!0,$("body").addClass("dragging")},stopDragging:function(){this.__draggingObject&&($("body").hasClass("dragging droppable")&&($("body").hasClass("droppable-on-editor")?this.getAllSelected().find(">div.icon.file").dblclick():this.drop()),this.__draggingObject.empty().hide()),this.__draggingObject=null,this.__dragging=!1,$("body").removeClass("dragging droppable not-droppable droppable-on-editor"),$(".drop-target").removeClass("drop-target")},drag:function(a){var b=a.pageX-$(window).scrollLeft()+10,c=a.pageY-$(window).scrollTop()+3;this.__draggingObject.css({top:c+"px",left:b+"px"})},isDroppable:function(a){if(null==base.file.__draggingObject)return!1;for(var b=!0,c=a.data("url"),d=base.file.__draggingObject.find("li"),e=0,f=null;f=d.get(e++);){var g=$(f).data("clone-url");if(c.indexOf(g)>-1){b=!1;break}}return b},drop:function(){var a=$(".drop-target").data("url"),b=base.thisEl&&base.thisEl.ctrlKey;base.thisEl={dir:a},b?this.copyTo():this.moveTo()},fetchFileName:function(a){return $(base.options.configAce.tabListUl+">li#panel_nav_"+a).find("a.ui-tabs-anchor").html().replace(/<span.*?>.*?<\/span>/m,"").trim()},isChanged:function(a){return $(base.options.configAce.tabListUl+">li#panel_nav_"+a).find("a.ui-tabs-anchor span").length>0},getTree:function(){return $("ul:first",base.options.configTree.treeRootElement)},toggleDir:function(a){return a.hasClass("active")||a.hasClass("loaded")?(a.toggleClass("active"),void this.saveState(a)):void this.dir(a)},saveState:function(a){$.post("file/saveState",{url:a.data("url"),state:a.hasClass("active")?"expand":"collapse"})},reload:function(){var a=$(base.options.configTree.treeRootElement);if(a.is(":visible")&&(!a.hasClass("loaded")||a.hasClass("workspace-changed")))return base.workspace.getActiveDirectory()?void $.ajax({type:"POST",url:"file/getState",dataType:"json",data:{url:base.workspace.getActiveDirectory()}}).done(function(a){base.file.restore(a&&a.restore),$(base.options.configTree.treeRootElement).addClass("loaded").removeClass("workspace-changed")}).error(function(){base.file.restore(!1)}):($.notify("No active workspace.","info"),void base.file.restore(!1))},changed:function(){var a=$(base.options.configTree.treeRootElement);a.hasClass("loaded")&&a.addClass("workspace-changed"),this.reload()},projectChanged:function(){var a=$("ul.itemtoolbaroptions li.project-change ul.project-list",'[data-manager-id="files_manager_container"]');a.hasClass("loaded")&&a.addClass("changed"),this.reloadProjects()},reloadProjects:function(){var a=$("ul.itemtoolbaroptions li.project-change ul.project-list",'[data-manager-id="files_manager_container"]');!$(base.options.configTree.treeRootElement).is(":visible")||a.hasClass("loaded")&&!a.hasClass("changed")||$.ajax({type:"POST",url:"workspace/",dataType:"json"}).done(function(a){if(null!=a&&"string"!=typeof a){if(a.status){var b=$("ul.itemtoolbaroptions li.project-change ul.project-list",'[data-manager-id="files_manager_container"]');b.find(">li.project").remove();var c=a.workspaces;if(base.workspace.__list=c,c)for(var d in c){var e=c[d],f=$("<li class='project'>").appendTo(b);f.attr("data-project-id",e.ws_directory),f.data("workspace",e),e.ws_active&&f.append("<i class='fa fa-check'></i>"),$("<span>").html(e.ws_name).appendTo(f)}}base.showMessages(a.messages)}})},changeProject:function(a){base.request({type:"POST",url:"workspace/activate",dataType:"json",data:{name:a},callback:function(a){var b=$("ul.itemtoolbaroptions li.project-change ul.project-list",'[data-manager-id="files_manager_container"]');b.find(">li.project > i").remove();var c=$(">li.project[data-project-id='"+a.ws.ws_directory+"']",b).prepend("<i class='fa fa-check'></i>");base.workspace.changed(!0),base.workspace.setActive(c.data("workspace"))}})},restore:function(a){if($(base.options.configTree.treeRootElement).empty(),base.workspace.getActive()){var b=this.createFileNode({name:base.workspace.getActiveName(),url:base.workspace.getActiveDirectory(),type:"dir",restore:a}).appendTo(this.createDirContentNode(0).appendTo(base.options.configTree.treeRootElement)).data("is-workspace-root",!0);a&&this.dir(b)}},expandAll:function(a){a||(a=$(">ul.filenavlist",base.options.configTree.treeRootElement)),a.find(">li.subdir").each(function(){var a=$(this);a.hasClass("active")||(a.hasClass("loaded")?(a.addClass("active"),base.file.saveState(a),base.file.expandAll(a.find(">ul.filenavlist"))):(a.addClass("expanding"),a.hasClass("loading")||base.file.dir(a)))})},collapseAll:function(){$("li",base.options.configTree.treeRootElement).removeClass("active"),$(">ul.filenavlist.filelvl1 > li",base.options.configTree.treeRootElement).each(function(){base.file.saveState($(this))})},refresh:function(){$("li.selected.subdir",base.options.configTree.treeRootElement).each(function(){var a=$(this);a.hasClass("loaded")&&a.removeClass("loaded"),a.hasClass("active")&&(a.addClass("restoring"),base.file.dir(a))})},getDir:function(a){return"/"==a.substr(a.length-1)&&(a=a.substr(0,a.length-1)),a.substr(0,a.lastIndexOf("/")+1)},__onChange:function(a){$(base.options.configTree.treeRootElement).is(":visible")&&this.reloadDir(this.getDir(a))},reloadDir:function(a,b){var c=$("li[data-url='"+a+"']",base.options.configTree.treeRootElement);c.length<=0||(c.hasClass("loaded")&&c.removeClass("loaded"),(b||c.hasClass("active"))&&this.dir(c))},startLoading:function(a){a.removeClass("loaded").addClass("loading"),a.find(">.subdirarrow").append("<span class='loader'><i class='fa fa-spin fa-spinner'></i></span>")},stopLoading:function(a){a.find(">.subdirarrow").find(".loader").remove(),a.removeClass("loading").addClass("loaded")},dir:function(a){base.file.clearCommand(),this.startLoading(a),$.ajax({type:"POST",url:"file/dir",dataType:"json",data:{dir:a.data("url"),restore:a.hasClass("restoring")?1:0}}).done(function(a){base.file.dirCallback(a)}).error(function(){base.file.dirCallback()})},dirCallback:function(a){var b=null;if(a&&(b=$("[data-url='"+a.dir+"']",base.options.configTree.treeRootElement)),!a||!a.status)return $.notify("Unknown error.","error"),void(b&&b.length>0&&base.file.stopLoading(b));var c=b.find(">ul.filenavlist");if(c.length>0?c.empty():c=this.createDirContentNode(b.parents(".filenavlist").length),a.files.length>0)for(var d=0,e=null;e=a.files[d++];)this.createFileNode(e).appendTo(c);c.appendTo(b),this.stopLoading(b),b.hasClass("active")||(b.addClass("active"),this.saveState(b)),b.hasClass("expanding")?(b.removeClass("expanding restoring"),this.expandAll(c)):b.hasClass("restoring")&&(c.find(">li.subdir.restoring").each(function(){base.file.dir($(this))}),b.removeClass("restoring"))},createDirContentNode:function(a){var b=$('<ul class="filenavlist">');return b.addClass("filelvl"+(a+1)),b},createFileNode:function(a){var b=$("<li data-url='"+a.url+"'>");return"dir"==a.type?(b.addClass("subdir"),$('<div class="subdirarrow">').appendTo(b)):b.data("id",a.id),$('<div class="icon '+a.type+" "+this.getExtension(a.name)+'"><span>'+a.name+"</span></div>").appendTo(b),a.restore&&b.addClass("restoring"),b},getAllSelected:function(){return $("li.selected",base.options.configTree.treeRootElement)},getSelected:function(){return $("li.selected.selected-last",base.options.configTree.treeRootElement)},isSelected:function(){return this.getAllSelected().length>0},isDirSelected:function(){return this.getSelected().find(">div.icon").hasClass("dir")},isRootSelected:function(){var a=this.getAllSelected(),b=a.length;if(b>0)for(var d,c=0;d=a[c++];)if($(d).data("is-workspace-root"))return!0;return!1},isZipSelected:function(){if(this.isSelected()&&!this.isRootSelected()){var a=base.file.getExtension(this.getSelected().data("url"));if("zip"==a||"tar"==a||"tar.gz"==a)return!0}return!1},getSelectedURL:function(a){return"dir"!=a||this.isSelected()?this.getSelected().data("url"):base.workspace.getActiveDirectory()},getSelectedDir:function(){return this.isSelected()?this.isDirSelected()?this.getSelected().data("url"):this.getSelected().closest("li.subdir").data("url"):base.workspace.getActiveDirectory()},getAllSelectedURLs:function(){var a=[];return this.getAllSelected().each(function(){a[a.length]=$(this).data("url")}),a},dir2json:function(){e=base.thisEl,$.post("file/dir2json",e,function(a){if($("#config").length>0){var b=$("#config").get(0),c=b.contentWindow||b.contentDocument;c.updateLocalServer(a)}else{var b=$("#popupcontent"+base.popupId).get(0),c=b.contentWindow||b.contentDocument;c.updateLocalServer(a)}})},__newCount:0,_new:function(){base.tab.openFile({id:base.generateUniqueId(),url:"",name:"new"+(this.__newCount>0?" "+this.__newCount:"")}),this.__newCount++},_newFromContext:function(a,b){var c="new."+b;$('<iframe src="'+base.options.baseUrl+"file/getFromContext?context="+unescape(a)+'" style="display: none;" />').appendTo("body").on("load",function(a){var b=$(this).contents().find("html:first").find("body:first").html();$(this).remove(),base.tab.openFile({id:base.generateUniqueId(),url:"",name:c,content:b}),base.tab.markChanged()})},_newDir:function(dir){var fileURL=base.workspace.getActiveDirectory();"undefined"!=typeof dir&&""!=dir?fileURL=dir:this.isDirSelected()&&(fileURL=this.getSelectedURL());var fileName="untitled";"undefined"!=typeof base.thisEl&&"undefined"!=typeof base.thisEl.fileName&&(fileName=base.thisEl.fileName);var e={dir:fileURL,name:fileName,type:"dir"};$.post("file/create",e,function(data){var json=eval("("+data+")");base.file.addFileNodeInDir(json)})},_delete:function(){var a=this.getAllSelectedURLs();a.length<=0||$.ajax({type:"POST",url:"file/delete",dataType:"json",data:{urls:a}}).done(function(a){base.file.getAllSelected().each(function(){base.tab.closeByURL($(this).data("url"))}).remove()}).error(function(){})},openFromLocal:function(){var a=base.thisEl;base.tab.openFile({id:a.id,url:a.path,name:a.name})},__srcURLs:null,__command:null,clearCommand:function(){this.clearClipboard(),this.__command=null},isClipboardEmpty:function(){return null==this.__srcURLs},fillClipboard:function(){this.__srcURLs=this.getAllSelectedURLs()},clearClipboard:function(){this.__srcURLs=null},cut:function(){this.fillClipboard(),this.__command=COMMAND_CUT},copy:function(){this.fillClipboard(),this.__command=COMMAND_COPY},paste:function(){if(!(null==this.__srcURLs||this.__srcURLs.length<=0)){for(var a=[],b=0,c=null;c=this.__srcURLs[b++];){var d=c,e=d,f="file";"/"==d.substr(d.length-1)&&(e=d.substr(0,d.length-1),f="dir");var g=e.lastIndexOf("/")+1,h=e.substr(0,g),i=e.substr(g),j=base.file.__command,k=this.getSelectedURL("dir");if(j==COMMAND_DUPLICATE&&(k=h),(j==COMMAND_CUT||j==COMMAND_COPY)&&k.indexOf(d)>-1)return void $.notify("You cannot paste a directory in the inner directory.","error");if(j==COMMAND_CUT&&h==k)return void $.notify("You cannot cut and paste a file in the same directory.","error");a[a.length]={name:i,dir:h,type:f}}var l={files:a,target_dir:k,command:j};j==COMMAND_CUT?base.process.start("Please wait while moving "+(a.length>1?"files":"a file")+"..."):base.process.start("Please wait while copying "+(a.length>1?"files":"a file")+"..."),$.ajax({type:"POST",url:"file/copy",dataType:"json",data:l}).done(function(a){if(a.status){if(a.files){if(base.file.addFileNodesInDir(a.files,a.dir),base.file.__command==COMMAND_CUT)for(var b=0,c=null;c=base.file.__srcURLs[b];)$("li[data-url='"+c+"']",base.options.configTree.treeRootElement).remove(),base.tab.updateFileByURL(c,a.files[b]),b++;j==COMMAND_CUT?$.notify(base.__tweakForPlural(a.files.length,"file")+" moved successfully.","success"):$.notify(base.__tweakForPlural(a.files.length,"file")+" copied successfully.","success")}base.file.__command!=COMMAND_COPY&&base.file.clearCommand()}base.process.stop(a.messages)}).error(function(b){j==COMMAND_CUT?$.notify("Unknown error occurred while moving "+(a.length>1?"files":"a file")+".","error"):$.notify("Unknown error occurred while copying "+(a.length>1?"files":"a file")+".","error"),base.process.stop()})}},duplicate:function(){this.fillClipboard(),this.__command=COMMAND_DUPLICATE,this.paste(),this.__command=null},addFileNodeInDir:function(a){var b=$("li[data-url='"+a.dir+"']",base.options.configTree.treeRootElement);if(!(b.length<=0)){var c=b.find(">ul.filenavlist");c.length<=0&&(c=base.file.createDirContentNode(b.parents(".filenavlist").length).appendTo(b));var d=c.find(">li[data-url='"+a.url+"']");d.length<=0&&(d=base.file.createFileNode(a).appendTo(c)),base.file.select(d),b.addClass("active")}},addFileNodesInDir:function(a,b){var c=$("li[data-url='"+b+"']",base.options.configTree.treeRootElement);if(!(c.length<=0)){var d=c.find(">ul.filenavlist");d.length<=0&&(d=base.file.createDirContentNode(c.parents(".filenavlist").length).appendTo(c)),base.file.deselect();for(var e=null,f=0,g=null;g=a[f++];)e=d.find(">li[data-url='"+g.url+"']"),e.length<=0&&(e=base.file.createFileNode(g).appendTo(d)),e.addClass("selected");e&&e.addClass("selected-last"),c.addClass("active")}},openRenameDialog:function(){base.openPopup({url:"editor/rename",title:"Rename"})},rename1:function(){var a=this.getSelectedURL();this.isDirSelected()&&(a=a.substr(0,a.length-1));var b=a.lastIndexOf("/")+1,c=a.substr(0,b),d=a.substr(b),e=base.thisEl,f={dir:c,from:d,to:e,type:this.isDirSelected()?"dir":"file"};$.ajax({type:"POST",url:"file/rename",dataType:"json",data:f}).done(function(b){base.file.getSelected().replaceWith(base.file.createFileNode(b).addClass("selected selected-last")),base.tab.updateFileByURL(a,b),base.closePopup()})},openMoveToDialog:function(){base.openPopup({url:"editor/moveTo",title:"Move To"})},moveTo:function(){var a=base.file.getAllSelectedURLs();if(!(null==a||a.length<=0)){for(var b=[],c="cut",d=base.thisEl.dir,e=0,f=null;f=a[e++];){var g=f,h=g,i="file";"/"==g.substr(g.length-1)&&(h=g.substr(0,g.length-1),i="dir");var j=h.lastIndexOf("/")+1,k=h.substr(0,j),l=h.substr(j);if(d.indexOf(g)>-1)return void $.notify("You cannot paste a directory in the inner directory.","error");if(k==d)return void $.notify("You cannot move a file in the same directory.","error");b[b.length]={name:l,dir:k,type:i}}var m={files:b,target_dir:d,command:c};base.process.start("Please wait while moving "+(b.length>1?"files":"a file")+"..."),$.ajax({type:"POST",url:"file/copy",dataType:"json",data:m}).done(function(a){if(a.status){if(a.files){var b=0;base.file.getAllSelected().each(function(){base.tab.updateFileByURL($(this).data("url"),a.files[b++])}).remove(),base.file.addFileNodesInDir(a.files,a.dir),$.notify(base.__tweakForPlural(a.files.length,"file")+" moved successfully.","success")}base.closePopup()}base.process.stop(a.messages)}).error(function(){$.notify("Unknown error occurred while moving "+(b.length>1?"files":"a file")+".","error"),base.process.stop()})}},openCopyToDialog:function(){base.openPopup({url:"editor/copyTo",title:"Copy To"})},copyTo:function(){var a=base.file.getAllSelectedURLs();if(!(null==a||a.length<=0)){for(var b=[],c="copy",d=base.thisEl.dir,e=0,f=null;f=a[e++];){var g=f,h=g,i="file";"/"==g.substr(g.length-1)&&(h=g.substr(0,g.length-1),i="dir");var j=h.lastIndexOf("/")+1,k=h.substr(0,j),l=h.substr(j);if(d.indexOf(g)>-1)return void $.notify("You cannot paste a directory in the inner directory.","error");b[b.length]={name:l,dir:k,type:i}}var m={files:b,target_dir:d,command:c};base.process.start("Please wait while copying files..."),$.ajax({type:"POST",url:"file/copy",dataType:"json",data:m}).done(function(a){a.status&&(a.files&&(base.file.addFileNodesInDir(a.files,a.dir),$.notify(base.__tweakForPlural(a.files.length,"file")+" copied successfully.","success")),base.closePopup()),base.process.stop(a.messages)}).error(function(){$.notify("Unknown error occurred while copying "+(b.length>1?"files":"a file")+".","error"),base.process.stop()})}},openSearchDialog:function(a){base.openPopup({url:"editor/search?tab="+a,title:"Search Files",modaless:!0})},search:function(){var a=base.thisEl,b=a.mode,c=a.needle,d=a.options;if(d.range=null,0==b){var e=base.getEditorInstance(base.tab.getActiveId());if(!e)return void $.notify("No active documents.","warn");e=e.instance;var f=e.find(c,d);"undefined"==typeof f&&$.notify("No matches found.","info")}else if(1==b){if(editors.length<=0)return void $.notify("No documents opened.","warn");d.needle=c,this.searchEditors(editors,d)}else if(2==b){var g=base.tab.getActiveId(),e=base.getEditorInstance(g);if(!e)return void $.notify("No active documents.","warn");e=e.instance,d.needle=c,this.searchEditors([{id:g,instance:e}],d)}},searchEditors:function(a,b){b.wrap=!0,b.backwards=!1;for(var c=[],d=0,e=0,f=0,g=null;g=a[f++];){var h=g.id;g=g.instance,g.$search.set(b);var i=g.$search.findAll(g.getSession());i&&i.length>0&&(d+=i.length,e++,c[c.length]={ranges:i,fileId:h,editor:g})}if(d>0){base.file.showSearchResults(),$("#searchresults_footerpane > div.footerpanetopbar div.footerpanetopbartxt").html("Current Search Results: "+d+" hits"),$("#searchresults_footerpane > div.sresultsgroupswrapper > div.sresultsgroup.active").removeClass("active");var j=$('<div class="sresultsgroup active"></div>').prependTo("#searchresults_footerpane>.sresultsgroupswrapper").hide();$('<div class="sresultstitle">Searched for "'+b.needle+'" ('+d+" hits in "+e+" files)</div>").appendTo(j);for(var k=$('<ul class="sresultsitemlist"></ul>'),l=0,m=null;m=c[l++];){var g=m.editor,h=m.fileId,i=m.ranges,n=base.tab.getURL(h);n=n?decodeURIComponent(n):"";var o=this.fetchFileName(h),p={fileId:h,fileName:o,fileURL:n},q=i.length,r=$('<li class="sresultitem"><div class="rsresultsticker"><span></span></div></li>').appendTo(k);base.stringToBoolean(base.options.configAce.search_collapse)||r.addClass("active"),r.data("file",p);var s=$('<div class="rsresultsoutput"></div>').appendTo(r);$('<div class="sresultitempath">'+(""==n?o:base.workspace.getNamedURL(n))+" ("+q+" hits)</div>").appendTo(s);for(var f=0,t=null;t=i[f++];){var u=t.start.row+1,v=g.session.getLine(t.start.row),w=v.substr(t.start.column,t.end.column-t.start.column),x=$('<div class="sresultitemdata"><span class="srlnnum">Line '+u+":</span> </div>").appendTo(s);x.data("range",t),$("<span>").text(v.substr(0,t.start.column)).appendTo(x),$('<span class="srmatch">').text(w).appendTo(x),t.end.column<v.length&&$("<span>").text(v.substr(t.end.column)).appendTo(x)}}k.appendTo(j),j.show(),$.notify(d+" match(es) found.","success"),base.closePopup()}else $.notify("No matches found.","info")},showSearch:function(){var a=base.thisEl,b=a.closest("li").data("file"),c=$("a[href='#panel_"+b.fileId+"']");if(c.length>0){c.closest("li").hasClass("ui-tabs-active")||c.click();var d=base.getEditorInstance(b.fileId);d&&(d=d.instance,d.selection.setRange(a.data("range")))}else b.fileURL&&(base.tab.openFile({id:b.fileId,url:b.fileURL,name:b.fileName}),$.notify("Please double click the search result again to move to the searched line.","info"))},replace:function(){var a=base.thisEl,b=a.mode,c=a.needle,d=a.replace,e=a.options;if(0==b)return this.search();if(1==b){var f=base.getEditorInstance(base.tab.getActiveId());if(!f)return void $.notify("No active documents.","warn");f=f.instance,e.needle=c;var g=f.selection.getRange();if(g){f.$search.set(e);var h=f.$search.findAll(f.getSession());if(h&&h.length>0)for(var i=0,j=null;j=h[i++];)g.start.row==j.start.row&&g.start.column==j.start.column&&g.end.row==j.end.row&&g.end.column==j.end.column&&f.replace(d,e)}var g=f.find(c,e);"undefined"==typeof g&&$.notify("No matches found.","info")}else if(2==b){var f=base.getEditorInstance(base.tab.getActiveId());if(!f)return void $.notify("No active documents.","warn");f=f.instance,e.needle=c,e.replaceInSelection&&(e.range=f.selection.getRange(),console.log(e.range)),f.$search.set(e);var k=f.replaceAll(d,e);k>0?$.notify(k+" match(es) replaced.","success"):$.notify("No matches found.","info")}else if(3==b){if(e.needle=c,editors.length<=0)return void $.notify("No documents opened.","warn");for(var k=0,i=0,f=null;f=editors[i++];)k+=f.instance.replaceAll(d,e);k>0?$.notify(k+" match(es) replaced.","success"):$.notify("No matches found.","info")}},searchInFiles:function(){var a=base.thisEl;base.closePopup(),base.process.start("Finding in files..."),$.ajax({type:"POST",
url:"file/search",dataType:"json",data:a}).done(function(b){var c=b.searches;if(null==c||c.length<=0)return $.notify("No matches found.","info"),void base.process.stop();for(var d=0,e=0,f=null;f=c[e++];)d+=f.ranges.length;var g=c.length;base.file.showSearchResults(),$("#searchresults_footerpane > div.footerpanetopbar div.footerpanetopbartxt").html("Current Search Results: "+d+" hits"),$("#searchresults_footerpane > div.sresultsgroupswrapper > div.sresultsgroup.active").removeClass("active");var h=$('<div class="sresultsgroup active"></div>').prependTo("#searchresults_footerpane>.sresultsgroupswrapper").hide();$('<div class="sresultstitle">Searched for "'+a.needle+'" ('+d+" hits in "+g+" files)</div>").appendTo(h);for(var i=$('<ul class="sresultsitemlist"></ul>'),j=0,f=null;f=c[j++];){var k=f.fileId,l=f.ranges,m=f.fileURL,n=f.fileName,o={fileId:k,fileName:n,fileURL:m},p=l.length,q=$('<li class="sresultitem"><div class="rsresultsticker"><span></span></div></li>').appendTo(i);base.stringToBoolean(base.options.configAce.search_collapse)||q.addClass("active"),q.data("file",o);var r=$('<div class="rsresultsoutput"></div>').appendTo(q);$('<div class="sresultitempath">'+(""==m?n:base.workspace.getNamedURL(m))+" ("+p+" hits)</div>").appendTo(r);for(var e=0,s=null;s=l[e++];){var t=s.start.row+1,u=s.line,v=u.substr(s.start.column,s.end.column-s.start.column),w=$('<div class="sresultitemdata"><span class="srlnnum">Line '+t+":</span> </div>").appendTo(r);w.data("range",s),$("<span>").text(u.substr(0,s.start.column)).appendTo(w),$('<span class="srmatch">').text(v).appendTo(w),s.end.column<u.length&&$("<span>").text(u.substr(s.end.column)).appendTo(w)}}i.appendTo(h),h.show(),$.notify(d+" match(es) found.","success"),base.process.stop()}).error(function(){$.notify("Unknown errors.","error"),base.process.stop()})},replaceInFiles:function(){var a=base.thisEl;base.closePopup(),base.process.start("Replacing in files..."),$.ajax({type:"POST",url:"file/replace",dataType:"json",data:a}).done(function(a){return null==a||a.replacedCount<=0?($.notify("No matches found.","info"),void base.process.stop()):($.notify(a.replacedCount+" match(es) replaced.","success"),void base.process.stop())}).error(function(){$.notify("Unknown errors.","error"),base.process.stop()})},showSearchResults:function(){base.layout.openPane("searchresults")},open:function(a){"undefined"==typeof a&&(a=base.thisEl),base.tab.openFile(a)},getExtension:function(a){try{var b=a.substring(a.lastIndexOf("/")+1),c=/(?:\.([^.]+))?$/;return $.trim(c.exec(b)[1])}catch(a){return""}},isValidFileType:function(a){return""!=base.getModeExtension(this.getExtension(a))||base.isImage(a)===!0},save:function(a){var b=base.tab.getData(a),c=b.url;if(b.isNew)return base.tab.activate(a),$('[data-action="saveAs"]').click(),!1;var d=base.getEditorInstance(a).instance.getSession().getValue();return $.ajax({type:"POST",url:"file/save",dataType:"json",data:{url:unescape(c),content:d}}).done(function(b){b.status&&base.file.__saved(a),base.showMessages(b.messages)}),b.isRemote&&base.ftp.saveRemoteFile(a,d,b.remoteInfo.connection),!0},__saved:function(a){return base.file.isClosingAll()?(base.tab.close(base.tab.getActiveId()),base.file.continueClosing()):base.file.isClosing()?(base.tab.close(base.tab.getActiveId()),base.file.finishClosing()):(base.tab.markUnchanged(a),base.command.disable("saveFile"),void(base.file.isSavingAll()&&base.file.continueSaving()))},saveAs:function(){var a=base.thisEl,b=base.getEditorInstance(base.tab.getActiveId()).instance.getSession().getValue();a.content=b,$.ajax({type:"POST",url:"file/saveAs",dataType:"json",data:a}).done(function(a){if(a.status){if(base.closePopup(),base.file.addFileNodeInDir(a),base.file.isClosingAll())return base.tab.close(base.tab.getActiveId()),base.file.continueClosing();if(base.file.isClosing())return base.tab.close(base.tab.getActiveId()),base.file.finishClosing();var b=base.tab.getActiveId();base.tab.markUnchanged(b),base.tab.updateFileById(b,a);var c=base.getModeExtension(base.getExtension(a.name));editor=base.getEditorInstance(a.id).instance,base.stringToBoolean(base.options.configAce.autoSetMode)&&""!=c?editor.getSession().setMode("ace/mode/"+c):editor.getSession().setMode("ace/mode/"+base.options.configAce.setMode),base.file.isSavingAll()&&base.file.continueSaving()}base.showMessages(a.messages)})},__savingAll:!1,__activeTab:null,isSavingAll:function(){return this.__savingAll},saveAll:function(){this.__savingAll=!0,this.__activeTab=base.tab.getActiveId(),this.continueSaving()},continueSaving:function(){var a=$(base.options.configAce.tabListUl+" li a.ui-tabs-anchor span");a.length>0?this.save(a.closest("li").data("tab-id")):this.finishSavingAll()},finishSavingAll:function(){this.__savingAll=!1,base.tab.activate(this.__activeTab),this.__activeTab=null},download:function(){var a=base.thisEl,b=$("form#downloadForm");null==b[0]&&(b=$("<form style='display: none' id='downloadForm' method='post' action='file/download'><input type='text' name='name' /><input type='text' name='dir' /></form>").appendTo("body")),$("[name='name']",b).val(a.name),$("[name='dir']",b).val(a.dir),b.submit()},saveToLocal:function(){var a=base.thisEl;a.content=base.getEditorInstance(base.tab.getActiveId()).instance.getSession().getValue();var b=$("form#saveToLocalForm");null==b[0]&&(b=$("<form style='display: none' id='saveToLocalForm' method='post' action='file/saveToLocal'><input type='text' name='name' /><textarea name='content'></textarea></form>").appendTo($("body",$(document))[0])),$("[name='name']",b).val(a.name),$("[name='content']",b).text(a.content),b.submit()},rename:function(){var a=base.thisEl;$.ajax({type:"POST",url:"file/rename",dataType:"json",data:a}).done(function(b){base.file.updateByURL(a.dir+a.from+("dir"==a.type?"/":""),b),a.type=null,base.file.dir2json()})},deleteFiles:function(){var a=base.thisEl;$.post("file/deleteFiles/",a,function(b){base.thisEl={dir:a[1].dir},base.file.dir2json();for(var c in a){var d=a[c];base.file.removeByURL(d.dir+d.fileUrl+("dir"==d.type?"/":""))}})},createNew:function(){var a=base.thisEl;$.ajax({type:"POST",url:"file/saveAs",dataType:"json",data:a}).done(function(b){a.type="",base.file.dir2json(),base.file.reloadDir(a.dir),base.showMessages(b.messages)})},__closing:!1,isClosing:function(){return this.__closing},close:function(a){this.isChanged(a)?(base.tab.activate(a),$.alert.open({type:"confirm",content:'Do you want to save "'+this.fetchFileName(a)+'"?',buttons:{yes:"Yes",no:"No",cancel:"Cancel"},callback:function(b){"yes"==b?(base.file.__closing=!0,base.file.save(a)):"no"==b?(base.tab.close(a),base.file.isClosingAll()&&base.file.continueClosing()):base.file.isClosingAll()&&base.file.finishClosingAll()}})):(base.tab.close(a),this.isClosingAll()&&this.continueClosing())},finishClosing:function(){this.__closing=!1},__closingAll:!1,__closingDirection:null,__current:null,isClosingAll:function(){return this.__closingAll},closeAll:function(){this.__closingAll=!0,base.tab.startProcessingMultipleTabs(),this.continueClosing()},closeOther:function(a){this.__closingAll=!0,this.__current=a,this.__closingDirection="other",base.tab.startProcessingMultipleTabs(),this.continueClosing()},closeLeft:function(a){this.__closingAll=!0,this.__current=a,this.__closingDirection="left",base.tab.startProcessingMultipleTabs(),this.continueClosing()},closeRight:function(a){this.__closingAll=!0,this.__current=a,this.__closingDirection="right",base.tab.startProcessingMultipleTabs(),this.continueClosing()},continueClosing:function(){if(this.__closingDirection){if("left"==this.__closingDirection){var b=this.__current.prev();b.length?this.close(b.data("tab-id")):this.finishClosingAll()}else if("right"==this.__closingDirection){var c=this.__current.next();c.length?this.close(c.data("tab-id")):this.finishClosingAll()}else if("other"==this.__closingDirection){var a=$(base.options.configAce.tabListUl+">li");a.length>1?0===a.index(this.__current)?this.close($(a.get(1)).data("tab-id")):this.close($(a.get(0)).data("tab-id")):this.finishClosingAll()}}else{var a=$(base.options.configAce.tabListUl+">li");a.length>0?this.close($(a.get(0)).data("tab-id")):this.finishClosingAll()}},finishClosingAll:function(){base.tab.stopProcessingMultipleTabs(),this.__closingAll=!1,this.__closingDirection=null,this.__currentTab=null,this.finishClosing()},previewSelected:function(){var a=this.getSelected().data("url");base.workspace.preview(a)},previewActiveTab:function(){var a=base.tab.getURL(base.tab.getActiveId());base.workspace.preview(a)},compressAllSelected:function(){var a=this.getSelectedURL(),b=this.getDir(a),c=(b==base.workspace.getActiveDirectory()?base.workspace.getActiveName():b.replace(this.getDir(b),"").replace("/",""))+".zip";base.request({url:"file/compress",data:{urls:this.getAllSelectedURLs(),dir:b,name:c},showProcessing:!0,messageForProcessing:"Please wait while compressing the selected files...",callback:function(a){base.file.reloadDir(a.dir)}})},openCompressAsDialog:function(){base.openPopup({url:"file/compressAs",title:"Compress As"})},compressAs:function(){base.request({url:"file/compress",data:{urls:this.getAllSelectedURLs(),dir:base.thisEl.dir,name:base.thisEl.name},showProcessing:!0,messageForProcessing:"Please wait while compressing the selected files...",callback:function(a){base.file.reloadDir(a.dir),base.closePopup()}})},extractSelected:function(){if(this.getAllSelected().length>1)return void $.notify("Only one archive can be selected for extraction at a time.","warn");var a=this.getSelectedURL(),b=this.getDir(a);base.request({url:"file/extract",data:{url:a,dir:b},showProcessing:!0,messageForProcessing:"Please wait while extracting the selected archive...",callback:function(a){base.file.reloadDir(a.dir)}})},openExtractIntoDialog:function(){return this.getAllSelected().length>1?void $.notify("Only one archive can be selected for extraction at a time.","warn"):void base.openPopup({url:"file/extractInto",title:"Extract Into"})},extractInto:function(){var a=this.getSelectedURL(),b=base.thisEl.dir;base.request({url:"file/extract",data:{url:a,dir:b},showProcessing:!0,messageForProcessing:"Please wait while extracting the selected archive...",callback:function(a){base.file.reloadDir(a.dir),base.closePopup()}})}}}(),base.contextmenu=function(){return{onContextMenu:function(a){var a=base.thisEl;return a.target&&"#"+a.target.id==base.options.configTree.treeRootElement?(base.file.deselect(),!0):(a.target&&base.file.select($(a.target,base.options.configTree.treeRootElement).closest("li"),a),!0)},onShow:function(){var a=base.thisEl;base.file.isSelected()&&!base.file.isRootSelected()?(base.file.isDirSelected()?($("[data-alias='open']",a).closest(".b-m-item").hide().next().hide(),$("[data-alias='paste']",a).closest(".b-m-item").show(),a.disable("paste",base.file.isClipboardEmpty()),$("[data-alias='duplicate']",a).closest(".b-m-item").hide(),$("[data-alias='previewFile']",a).closest(".b-m-item").hide()):($("[data-alias='open']",a).closest(".b-m-item").show().next().show(),$("[data-alias='paste']",a).closest(".b-m-item").hide(),$("[data-alias='duplicate']",a).closest(".b-m-item").show(),$("[data-alias='previewFile']",a).closest(".b-m-item").show(),a.disable("previewFile",!base.workspace.isSandboxAvailable())),$("[data-alias='cut']",a).closest(".b-m-item").show(),$("[data-alias='copy']",a).closest(".b-m-item").show(),$("[data-alias='delete']",a).closest(".b-m-item").show(),$("[data-alias='refactor']",a).closest(".b-m-item").show().prev().show(),base.file.isZipSelected()?($("[data-alias='compress']",a).closest(".b-m-item").hide(),$("[data-alias='compressAs']",a).closest(".b-m-item").hide(),$("[data-alias='extract']",a).closest(".b-m-item").show(),$("[data-alias='extractInto']",a).closest(".b-m-item").show()):($("[data-alias='compress']",a).closest(".b-m-item").show(),$("[data-alias='compressAs']",a).closest(".b-m-item").show(),$("[data-alias='extract']",a).closest(".b-m-item").hide(),$("[data-alias='extractInto']",a).closest(".b-m-item").hide())):($("[data-alias='open']",a).closest(".b-m-item").hide().next().hide(),$("[data-alias='cut']",a).closest(".b-m-item").hide(),$("[data-alias='copy']",a).closest(".b-m-item").hide(),$("[data-alias='paste']",a).closest(".b-m-item").show(),a.disable("paste",base.file.isClipboardEmpty()),$("[data-alias='delete']",a).closest(".b-m-item").hide(),$("[data-alias='duplicate']",a).closest(".b-m-item").hide(),$("[data-alias='refactor']",a).closest(".b-m-item").hide().prev().hide(),$("[data-alias='previewFile']",a).closest(".b-m-item").hide(),$("[data-alias='compress']",a).closest(".b-m-item").hide(),$("[data-alias='compressAs']",a).closest(".b-m-item").hide(),$("[data-alias='extract']",a).closest(".b-m-item").hide(),$("[data-alias='extractInto']",a).closest(".b-m-item").hide()),a.disable("previewProject",!base.workspace.isSandboxAvailable())},onClick:function(){var a=base.thisEl;switch(a){case"open":base.tab.startProcessingMultipleTabs(),base.file.getAllSelected().find(">div.icon").dblclick(),base.tab.stopProcessingMultipleTabs();break;case"newFile":base.file._new();break;case"newFolder":var b="";base.file.isDirSelected()&&(b=base.file.getSelectedURL()),base.dirNew(b);break;case"newPHPFile":sceditor.call("base.fileNewFromContext('PHPFile', 'php')");break;case"newPHPClass":sceditor.call("base.fileNewFromContext('PHPClass', 'php')");break;case"newHTML":sceditor.call("base.fileNewFromContext('HTML', 'html')");break;case"newJavaScript":sceditor.call("base.fileNewFromContext('JavaScript', 'js')");break;case"newTypeScript":sceditor.call("base.fileNewFromContext('TypeScript', 'ts')");break;case"newCoffeeScript":sceditor.call("base.fileNewFromContext('CoffeeScript', 'coffee')");break;case"newXSLT":sceditor.call("base.fileNewFromContext('XSLT', 'xsl')");break;case"newCSS":sceditor.call("base.fileNewFromContext('CSS', 'css')");break;case"cut":base.file.cut();break;case"copy":base.file.copy();break;case"paste":base.file.paste();break;case"duplicate":base.file.duplicate();break;case"delete":base.file._delete();break;case"rename":base.file.openRenameDialog();break;case"moveTo":base.file.openMoveToDialog();break;case"copyTo":base.file.openCopyToDialog();break;case"search":base.file.openSearchDialog("find");break;case"uploadFiles":base.command.execute("uploadFiles");break;case"previewProject":base.workspace.preview();break;case"previewFile":base.file.previewSelected();break;case"compress":base.file.compressAllSelected();break;case"compressAs":base.file.openCompressAsDialog();break;case"extract":base.file.extractSelected();break;case"extractInto":base.file.openExtractIntoDialog()}}}}(),base.workspace=function(){return $("body").on("change",'div.workspace-row-item input[type="radio"]',function(a){var b=$(this).parents(".workspace-row-item").data("workspace"),c=b;$.ajax({type:"POST",url:"workspace/activate",dataType:"json",data:{name:c.ws_directory}}).done(function(a){if(null!=a&&"string"!=typeof a){if(a.status&&(base.workspace.setActive(a.ws),base.file.projectChanged(),base.workspace.isSandboxAvailable())){var b=$(".terminalwrapper iframe");b.length>0&&(b.src=base.options.baseUrl+"editor/terminal?domain="+base.workspace.getActive().ws_name)}base.showMessages(a.messages)}}).error(function(){$.notify("Couldn't change workspace. Please try again later.","error")})}),{__list:null,reload:function(){var a=$("#workspace-list");!a.is(":visible")||a.hasClass("loaded")&&!a.hasClass("changed")||$.ajax({type:"POST",url:"workspace/",dataType:"json"}).done(function(a){if(null!=a&&"string"!=typeof a){if(a.status){var b="",c=0,d=a.workspaces;if(base.workspace.__list=d,d)for(var e in d){c++;var f=d[e];b+="<li class='workspace-item'><div class='workspace-row-item' data-workspace='"+JSON.stringify(f)+"'><div class='input'><input id='ws-"+e+"' name='ws' "+(f.ws_active?"checked=''":"")+" type='radio' /><div class='clear'></div></div><div class='name'> <label for='ws-"+e+"'>"+f.ws_name+"</label><div class='clear'></div></div><div class='clear'></div></div></li>",f.ws_active&&base.workspace.setActive(f)}var g=$("#workspace-list");g.empty().append(b),$("#workspace-announcement-upgrade").hide(),$("#workspace-announcement-upgrade-for-zero").hide(),$("#workspace-announcement-available").hide(),$("#workspace-announcement-create").hide(),$("[data-manager-id='workspace_manager_container'] ul.leftcolcontrolslist > li").removeClass("disabled"),c>=a.limit?0==a.limit?($("#workspace-announcement-upgrade-for-zero").show(),$("[data-manager-id='workspace_manager_container'] ul.leftcolcontrolslist>li").addClass("disabled")):($("#workspace-announcement-upgrade .count").html(a.limit),$("#workspace-announcement-upgrade").show()):c<=0?($("#workspace-announcement-create").show(),$("[data-manager-id='workspace_manager_container'] ul.leftcolcontrolslist > li.edit").addClass("disabled"),$("[data-manager-id='workspace_manager_container'] ul.leftcolcontrolslist > li.delete").addClass("disabled"),$("[data-manager-id='workspace_manager_container'] ul.leftcolcontrolslist > li.export").addClass("disabled"),$("[data-manager-id='workspace_manager_container'] ul.leftcolcontrolslist > li.import").addClass("disabled")):($("#workspace-announcement-available .count").html(a.limit-c),$("#workspace-announcement-available").show()),g.addClass("loaded").removeClass("changed")}base.showMessages(a.messages)}})},changed:function(a){var b=$("#workspace-list");b.hasClass("loaded")&&b.addClass("changed"),this.reload(),a||base.file.projectChanged()},create:function(){return $("#workspace-announcement-upgrade").is(":visible")?void $("#workspace-announcement-upgrade").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100):void base.openPopup({url:base.thisEl.data("file-url"),title:base.thisEl.data("title")})},edit:function(){var a=null;if((a=$("#workspace-list li input[type='radio']:checked")).length<=0)return void $.notify("Please select workspaces to edit.","warn");var b=a.closest("div.workspace-row-item").data("workspace");base.openPopup({url:base.thisEl.data("file-url")+"/"+b.ws_directory,title:base.thisEl.data("title")})},remove:function(){var a=null;if((a=$("#workspace-list li input[type='radio']:checked")).length<=0)return void $.notify("Please select workspaces to delete.","warn");var b=a.closest("div.workspace-row-item").data("workspace");$.alert.open({type:"confirm",content:"Are you sure you want to delete the selected workspace?",cancel:!0,callback:function(a){"yes"==a&&$.ajax({type:"POST",url:"workspace/delete",dataType:"json",data:{workspace:b.ws_directory}}).done(function(a){null!=a&&"string"!=typeof a&&(a.status&&(base.workspace.changed(),base.workspace.setActive(null)),base.showMessages(a.messages))}).error(function(){$.notify("Unknown error occurred while deleting workspace.","error")})}})},export:function(){var a=null;return(a=$("#workspace-list li input[type='radio']:checked")).length<=0?void $.notify("Please select workspaces to export.","warn"):(base.process.start("Your selected workspace is being archived. Please wait a moment."),void $.ajax({type:"POST",url:"workspace/export?type=zip",dataType:"json"}).done(function(a){a&&"string"!=typeof a&&base.showMessages(a.messages),base.process.stop()}).error(function(){$.notify("Unknown error occurred while archiving the workspace.","error"),base.process.stop()}))},getActive:function(){return base.options.activeWorkspace},setActive:function(a){var b=!1;return!base.options.activeWorkspace&&a||base.options.activeWorkspace&&!a?b=!0:base.options.activeWorkspace.ws_directory!=a.ws_directory&&(b=!0),base.options.activeWorkspace=a,b&&base.file.changed(),base.options.activeWorkspace},getActiveName:function(){var a=this.getActive();return a?a.ws_name:null},getNamedURL:function(a){if(this.__list)for(var b in this.__list)a=a.replace(new RegExp(b,"g"),this.__list[b].ws_name);return a},getActiveDirectory:function(){var a=this.getActive();return a?a.ws_directory+"/":null},isSandboxAvailable:function(){var a=this.getActive();return a&&a.ws_domain},preview:function(a){var b=this.getActive();if(b&&b.ws_domain){var c="http://"+b.ws_domain;a&&(c+="/"+a.replace(this.getActiveDirectory(),""));var d=window.open(c,"preview");d.focus()}}}}(),base.ftp=function(){var ftp=new Object,inProcessServer=!1,inProcessLocal=!1;base.ftp.connect=function(a){ftp.ftp_host=a.ftp_host,ftp.ftp_domain=a.ftp_domain,ftp.ftp_log_id=a.ftp_log_id,ftp.ftp_protocol=a.ftp_protocol,ftp.dir=a.dir,base.tab.openRemoteSystem({id:ftp.ftp_log_id,url:"ftp/ftpconnection/"+ftp.ftp_log_id,title:"FTP Connection ("+a.ftp_host+")"},{connection:ftp.ftp_log_id,type:ftp.ftp_protocol.toLowerCase()})},base.ftp.showRemoteProcessing=function(a,b){inProcessServer=a,b.showProcessing("remote",inProcessServer)},base.ftp.isRemoteProcessing=function(){return inProcessServer},base.ftp.showLocalProcessing=function(a,b){inProcessLocal=a,b.showProcessing("local",inProcessLocal)},base.ftp.isLocalProcessing=function(){return inProcessLocal},base.ftp.getProtocol=function(a){var b=base.tab.getData(a);return b?b.remoteInfo.type.toLowerCase():null},base.ftp.reconnectServer=function(){if(this.isRemoteProcessing())return $.notify("Please wait. The program is busy with the remote server.","info"),!1;var a=base.thisEl,b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;this.showRemoteProcessing(!0,c);var d=this.getProtocol(a.ftp_log_id);d&&($.ajax({type:"POST",url:d+"/get_file_list",data:a}).done(function(b){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var c=$("#frame"+a.ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;"undefined"!=typeof d.updateRemoteServer&&d.updateRemoteServer(b),base.ftp.showRemoteProcessing(!1,d)}).error(function(){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!1,c)}),base.ftp.startStatusChecking({ftp_log_id:a.ftp_log_id}))},base.ftp.reconnectLocal=function(){if(this.isLocalProcessing())return $.notify("Please wait. The program is busy with the local server.","info"),!1;var a=base.thisEl,b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;this.showLocalProcessing(!0,c),base.ftp.getLocal(a)},base.ftp.edit=function(e){var totalChecked=new Array,len=$(".ftpsavedgrid li").each(function(index,element){if($(this).find('input[type="checkbox"]').is(":checked")){var json=eval("("+$(this).find("div.ftprowitem").data("ftp")+")");totalChecked.push(json.ftp_log_id)}});1==totalChecked.length?base.openPopup({url:base.thisEl.data("file-url")+"?id="+totalChecked[0],title:base.thisEl.data("title")}):$.notify("Please select only one host to edit.","warn")},base.ftp.saveRemoteFile=function(a,b,c){var d=$("#frame"+c).get(0);if(!d)return void $.notify("You cannot save this file because the connection tab is closed.","warn");var e=d.contentWindow||d.contentDocument;this.showRemoteProcessing(!0,e);var f=this.getProtocol(c);f&&(base.request({url:f+"/saveRemoteFile",data:{file_id:a,fileContent:b},callbackOnFailure:!0,callback:function(){base.ftp.stopStatusChecking({ftp_log_id:c}),base.ftp.showRemoteProcessing(!1,e)}}),base.ftp.startStatusChecking({ftp_log_id:c}))},base.ftp.reloadList=function(){var availableFtpConn=10;$('<iframe id="reloadList" src="'+base.options.baseUrl+'ftp/get_ftp_list/" style="display: none;" />').appendTo("body").on("load",function(n){if(elmnts=$(this).contents().find("html:first").find("body:first").html(),$(this).remove(),""!=elmnts){var str="",json=eval("("+elmnts+")");if(availableFtpConn=json.limit,json=json.list,!json)return;$("ul#ftpsavedgridlilist").empty(),Object.keys(json).length>0&&$.each(json,function(a,b){str=str+"<li class='ftpitem'><div class='ftprowitem' data-ftp=\"{'ftp_log_id':'"+b.ftp_log_id+"','ftp_host':'"+b.ftp_host+"','ftp_domain':'"+b.ftp_domain+"','ftp_protocol':'"+b.ftp_protocol+"'}\"><div class='ftpcheckbox input'><input type='checkbox' id='"+b.ftp_host+"' /><div class='clear'></div></div><div class='ftphostname name'><label for='"+b.ftp_host+"_checkbox'>"+b.ftp_domain+"</label><div class='clear'></div></div><div class='ftphostconndetails'><div class='ftpconlabel ftplabelhost first'><strong>Host:</strong> "+b.ftp_host+"</div><div class='ftpconlabel ftplabeluser'><strong>User:</strong> "+b.ftp_username+"</div><div class='ftpconlabel ftplabelpost'><strong>Port:</strong> "+b.ftp_port+"</div><div class='ftpconlabel ftplabelprotocol'><strong>Protocol:</strong> "+b.ftp_protocol+"</div><div class='ftpconlabel ftplabelmode last'><strong>Transfer Mode:</strong> "+(1==b.ftp_mode?"Active":"Passive")+"</div><div class='clear'></div></div><div class='clear'></div></div></li>"}),availableFtpConn>0&&Object.keys(json).length<availableFtpConn?Object.keys(json).length>0?str=str+"<div class='clear'></div><div class='ftpannouncement message'>You have "+(availableFtpConn-Object.keys(json).length)+" saved FTP connections remaining.</div>":str+="<div class='clear'></div><div class='ftpannouncement message'><a data-action-type='popup' data-title='Create New FTP Connection' data-file-url='ftp/ftpdetails'>Click here</a> to create your first FTP connection.</div>":str=str+"<div class='clear'></div><div class='ftpannouncement message'>Your membership does not allow any(more) FTP connections. <a href='"+base.options.baseUrl+"plans'>Click here</a> to upgrade your plan to add additional FTP functionality.</div>",$("ul#ftpsavedgridlilist").append(str)}})},base.ftp.delete=function(e){$.alert.open({type:"confirm",content:"Are you sure you want to delete the selected FTP connection?",cancel:!0,callback:function(e){if("yes"==e){var totalChecked=new Array,len=$(".ftpsavedgrid li").each(function(index,element){if($(this).find('input[type="checkbox"]').is(":checked")){var json=eval("("+$(this).find("div.ftprowitem").data("ftp")+")");totalChecked.push(json.ftp_log_id)}});$.post("ftp/delete_array/",{ftp_log_id:totalChecked},function(a){base.ftp.reloadList()})}}})},base.ftp.disconnect=function(a){"undefined"==typeof a&&(a=base.thisEl),base.request({url:"ftp/disconnect",data:{ftp_log_id:a},callback:function(){var b=$("#frame"+a).get(0);if(b){var c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!1,c)}}})},base.ftp.clearLog=function(){var a=base.thisEl;$.post("ftp/clearLog",a,function(b){var c=$("#frame"+a.ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;d.clearLog()})},base.ftp.getLocal=function(a){$.post("file/dir2json",a,function(b){var c=$("#frame"+a.ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;d.updateLocalServer(b),base.ftp.showLocalProcessing(!1,d)}).error(function(){var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showLocalProcessing(!1,c)})},base.ftp.openLocal=function(){base.tab.openFile(base.thisEl)},base.ftp.startStatusChecking=function(a,b){try{inProcessServer===!0?$.post("ftp/getstatus/",{ftp_log_id:a.ftp_log_id},function(c){var d=$("#frame"+a.ftp_log_id).get(0),e=d.contentWindow||d.contentDocument;e.updateLog(c),clearTimeout(timer),b||(timer=setTimeout(function(){base.ftp.startStatusChecking({ftp_log_id:a.ftp_log_id})},1600))},"json").error(function(){b||(timer=setTimeout(function(){base.ftp.startStatusChecking({ftp_log_id:a.ftp_log_id})},1600))}):clearTimeout(timer)}catch(a){clearTimeout(timer),alert(a)}},base.ftp.stopStatusChecking=function(a){clearTimeout(timer),base.ftp.startStatusChecking(a,!0)},base.ftp.connectClick=function(e){var totalChecked=new Array,len=$(".ftpsavedgrid li").each(function(index,element){$(this).find('input[type="checkbox"]').is(":checked")&&totalChecked.push(new Array($(this).find('input[type="checkbox"]'),eval("("+$(this).find("div.ftprowitem").data("ftp")+")")))});0==totalChecked.length?$.notify("Please select a host to connect to from the FTP host list and try again.","warn"):totalChecked.length>1?$.notify("You may connect to only one host at a time. Please select only one host and try again.","warn"):base.ftp.connect(totalChecked[0][1])},base.ftp.rename=function(){if(this.isRemoteProcessing())return $.notify("Please wait. Another action is still processing.","info"),!1;var a=base.thisEl;if("remote"==a.server){var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;this.showRemoteProcessing(!0,c),$.ajax({type:"POST",url:"ftp/ftp_rename",data:a}).done(function(b){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var c=$("#frame"+a.ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;"undefined"!=typeof c.updateRemoteServer&&(d.updateRemoteServer(b),d.updateConnectionStatus({text:"Connected",color:"green"})),base.ftp.showRemoteProcessing(!1,d)}).error(function(){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!1,c)}),base.ftp.startStatusChecking({ftp_log_id:a.ftp_log_id})}else{var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;this.showLocalProcessing(!0,c),$.post("file/rename/",a,function(b){base.ftp.getLocal(a),base.file.reloadDir(a.dir)})}},base.ftp.deleteFiles=function(){if(this.isRemoteProcessing())return $.notify("Please wait. Another action is still processing.","info"),!1;var a=base.thisEl,b={ftp_log_id:a[1].ftp_log_id,files:a};if("undefined"==typeof a[1])return!1;if("remote"==a[1].server){var c=$("#frame"+a[1].ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;base.ftp.showRemoteProcessing(!0,d);var e=this.getProtocol(b.ftp_log_id);if(!e)return;$.ajax({type:"POST",url:e+"/delete_ftp_file",data:b}).done(function(b){base.ftp.stopStatusChecking({ftp_log_id:a[1].ftp_log_id});var c=$("#frame"+a[1].ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;"undefined"!=typeof d.updateRemoteServer&&(d.updateRemoteServer(b),d.updateConnectionStatus({text:"Connected",color:"green"})),base.ftp.showRemoteProcessing(!1,d)}).error(function(){base.ftp.stopStatusChecking({ftp_log_id:a[1].ftp_log_id});var b=$("#frame"+a[1].ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!1,c)}),base.ftp.startStatusChecking({ftp_log_id:a[1].ftp_log_id})}else{var c=$("#frame"+a[1].ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;this.showLocalProcessing(!0,d),$.post("file/deleteFiles",a,function(b){var c=$("#frame"+a[1].ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;base.ftp.showLocalProcessing(!1,d),a[1].type="file";try{base.ftp.getLocal(a[1]),base.file.reloadDir(a[1].dir)}catch(a){console.log(a)}})}},base.ftp.createNew=function(){var a=base.thisEl;if("remote"==a.server){var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!0,c),$.ajax({type:"POST",url:"ftp/ftp_create_new",data:a}).done(function(b){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var c=$("#frame"+a.ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;"undefined"!=typeof c.updateRemoteServer&&(c.updateRemoteServer(b),c.updateConnectionStatus({text:"Connected",color:"green"})),base.ftp.showRemoteProcessing(!1,d)}).error(function(){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!1,c)}),base.ftp.startStatusChecking({ftp_log_id:a.ftp_log_id})}else{var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showLocalProcessing(!0,c);var a=base.thisEl;$.ajax({type:"POST",url:"file/create2",dataType:"json",data:a}).done(function(b){var c=$("#frame"+a.ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;base.ftp.showLocalProcessing(!1,d);try{a.type="",base.ftp.getLocal(a),base.file.reloadDir(a.dir)}catch(a){}base.showMessages(b.messages)})}},base.ftp.past=function(){var a=base.thisEl;if("undefined"==typeof a[1])return!1;var b={ftp_log_id:a[1].ftp_log_id,files:a},c=$("#frame"+a[1].ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;base.ftp.showRemoteProcessing(!0,d),base.ftp.showLocalProcessing(!0,d);var e=this.getProtocol(b.ftp_log_id);e&&($.ajax({type:"POST",url:e+"/past",data:b}).done(function(b){base.ftp.stopStatusChecking({
ftp_log_id:a[1].ftp_log_id});var c=$("#frame"+a[1].ftp_log_id).get(0);if(c){var d=c.contentWindow||c.contentDocument;"undefined"!=typeof d.updateRemoteServer&&(d.updateRemoteServer(b),d.updateConnectionStatus({text:"Connected",color:"green"})),base.ftp.showRemoteProcessing(!1,d);try{var e="";"local"==a[1].from?e=a[1].copy_directory:"local"==a[1].to&&(e=a[1].past_directory),base.ftp.getLocal({dir:e,ftp_log_id:a[1].ftp_log_id,workspace:a[1].workspace}),base.file.reloadDir(e)}catch(b){var c=$("#frame"+a[1].ftp_log_id).get(0),d=c.contentWindow||c.contentDocument;base.ftp.showLocalProcessing(!1,d)}}}).error(function(){var b=$("#frame"+a[1].ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!1,c),base.ftp.showLocalProcessing(!1,c),base.ftp.stopStatusChecking({ftp_log_id:a[1].ftp_log_id})}),base.ftp.startStatusChecking({ftp_log_id:a[1].ftp_log_id}))},base.ftp.editRemoteFile=function(){var a=base.thisEl;if("undefined"==typeof a.ftp_log_id)return!1;var b=$("#frame"+a.ftp_log_id).get(0),c=b.contentWindow||b.contentDocument;base.ftp.showRemoteProcessing(!0,c);var d=this.getProtocol(a.ftp_log_id);d&&(base.request({type:"POST",url:d+"/editRemoteFile",data:a,callback:function(b){base.ftp.stopStatusChecking({ftp_log_id:a.ftp_log_id});var c=$("#frame"+a.ftp_log_id).get(0),e=c.contentWindow||c.contentDocument;base.ftp.showRemoteProcessing(!1,e);var f=b.file;f&&(base.thisEl.ftp_log_id=b.ftp_log_id,base.tab.openRemoteFile(f,{connection:b.ftp_log_id,type:d}))},callbackOnFailure:!0}),base.ftp.startStatusChecking({ftp_log_id:a.ftp_log_id}))},base.ftp.__refreshRemoteFile=function(a,b){var c={ftp_log_id:a.remoteInfo.connection,file_id:a.id},d=$("#frame"+c.ftp_log_id).get(0),e=d.contentWindow||d.contentDocument;base.ftp.showRemoteProcessing(!0,e);var f=a.remoteInfo.type;base.request({type:"POST",url:f+"/refreshRemoteFile",data:c,callback:function(a){base.ftp.stopStatusChecking({ftp_log_id:c.ftp_log_id});var d=$("#frame"+c.ftp_log_id).get(0),e=d.contentWindow||d.contentDocument;base.ftp.showRemoteProcessing(!1,e),b()},callbackOnFailure:!0}),base.ftp.startStatusChecking({ftp_log_id:c.ftp_log_id})},base.ftp.deleteRemoteTempFile=function(a){base.request({url:"ftp/deleteRemoteTempFile",data:{id:a}})}},base.database=function(){return{reload:function(){$.ajax({type:"POST",url:"database/",dataType:"json"}).done(function(a){if(null!=a&&"string"!=typeof a){if(!a.status)return void alert("error");var b="",c=0;for(var d in a.list){c++;var e=a.list[d];b+="<li class='database-item'><div class='database-row-item' data-database='"+e+"'><div class='input'><input id='db-"+d+"' name='db' type='checkbox' /><div class='clear'></div></div><div class='name'><label for='db-"+d+"'>"+e+"</label><div class='clear'></div></div><div class='clear'></div></div></li>"}$("#database-list").empty().append(b),$("#database-announcement-upgrade").hide(),$("#database-announcement-upgrade-for-zero").hide(),$("#database-announcement-available").hide(),$("#database-announcement-create").hide(),$("#database-announcement-userinfo").hide(),$("[data-manager-id='database_manager_container'] ul.leftcolcontrolslist > li").removeClass("disabled"),c>=a.limit?0==a.limit?($("#database-announcement-upgrade-for-zero").show(),$("[data-manager-id='database_manager_container'] ul.leftcolcontrolslist > li").addClass("disabled")):($("#database-announcement-upgrade .count").html(a.limit),$("#database-announcement-upgrade").show()):c<=0?($("#database-announcement-create").show(),$("[data-manager-id='database_manager_container'] ul.leftcolcontrolslist>li.edit").addClass("disabled"),$("[data-manager-id='database_manager_container'] ul.leftcolcontrolslist>li.connect").addClass("disabled"),$("[data-manager-id='database_manager_container'] ul.leftcolcontrolslist>li.delete").addClass("disabled"),$("#database-announcement-userinfo").show()):($("#database-announcement-available .count").html(a.limit-c),$("#database-announcement-available").show(),$("#database-announcement-userinfo").show())}})},create:function(){return $("#database-announcement-upgrade").is(":visible")?void $("#database-announcement-upgrade").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100):void base.openPopup({url:base.thisEl.data("file-url"),title:base.thisEl.data("title")})},rename:function(){var a=new Array;$("#database-list li").each(function(b,c){if($(this).find('input[type="checkbox"]').is(":checked")){var d=$(this).find("div.database-row-item").data("database");a.push(d)}});1==a.length?base.openPopup({url:base.thisEl.data("file-url")+"?name="+a[0],title:base.thisEl.data("title")}):a.length<1?$.notify("Please select a database to edit.","warn"):$.notify("Please select only one database to edit.","warn")},remove:function(){var a=new Array;$("#database-list li").each(function(b,c){if($(this).find('input[type="checkbox"]').is(":checked")){var d=$(this).find("div.database-row-item").data("database");a.push(d)}});return a.length<1?void $.notify("Please select databases to delete.","warn"):void $.alert.open({type:"confirm",content:"Are you sure you want to delete the selected database?",cancel:!0,callback:function(b){"yes"==b&&$.post("database/delete",{names:a},function(a){base.database.reload()})}})},connect:function(){window.open("database/connect?"+(new Date).getTime(),"_blank")}}}(),base.template=function(){return{openSaveWnd:function(a){this.__selected_id=base.thisEl,base.openPopup({url:"template/save/"+this.__selected_id,title:"New From Template"})},getSelectedId:function(){return this.__selected_id},create:function(){var a=base.thisEl;a.template_id=this.getSelectedId(),base.process.start("The selected template is being loaded into your project. Please wait a moment."),$.ajax({type:"POST",url:"template/create",dataType:"json",data:a}).done(function(b){base.file.reloadDir(a.dir,!0),base.process.stop(),$.notify("Your template selection has successfully been loaded.","success"),base.closePopup()}).error(function(a){console.log("Error while saving template.",a)})}}}(),base.process=function(){return{__processing:!1,start:function(a){var b=this.getLoader();$(".statusloaderbackdrop_noticetxt",b).html("<div class='noticetxt'>"+a+"</div><div class='noticeicon'><i class='fa fa-spin fa-spinner'></i></div>"),b.show(),this.__processing=!0},stop:function(a){this.getLoader().hide(),this.__processing=!1,a&&base.showMessages(a)},getLoader:function(){var a=$("#statusloader");return a.length<=0&&(a=$('<div id="statusloader" class="statusloaderbackdrop"><div class="statusloadbackdrop_inside"><div class="statusloaderbackdrop_notice waiting" style=""><div class="statusloaderbackdrop_noticetxt"></div></div></div></div>').appendTo("body")),a}}}(),base.widget=function(){return{init:function(a,b){if(this.__options=b?b:{},a)for(var c=0,d=null;d=a[c++];)this.enable(d),this.__options[d.widget_id]&&1==this.__options[d.widget_id].open&&this.run(d);$("#sidebartoolslist").on("click",".sidetool_widget",function(a){var b=$(this).data("widget");base.widget.run(b),base.widget.saveOption(b.widget_id,"open",1)})},enable:function(a){"undefined"==typeof a&&(a=base.thisEl),$("#sidebartoolslist #widgetshortcut"+a.widget_id).length>0||$('<li class="sidetool sidetool_widget"><div id="widgetshortcut'+a.widget_id+'" title="'+a.title+'"><img src="'+base.options.baseUrl+a.icon_url+'"/></div></li>').data("widget",a).appendTo("#sidebartoolslist")},disable:function(a){$("#sidebartoolslist #widgetshortcut"+a).parent().remove()},run:function(a){var b=$("#widget"+a.widget_id);if(b.length<=0){var c=function(b){var c=$(this),d=this.contentWindow||this.contentDocument;base.key.hook(d);var e=c.contents().find("body").css({"-webkit-box-sizing":"border-box"}),f=c.parent(),g=f.dialog("instance"),h=base.widget.__options[a.widget_id],i="undefined"!=typeof h?h.size:null,j=0,k=0,l=g.widget();if(i)j=parseFloat(i.width),k=parseFloat(i.height);else var j=e[0].scrollWidth-f.width()+l.width()+10,k=e[0].scrollHeight-f.height()+l.height()+10;var m=g.option("maxHeight");k>m&&(k=m);var n=g.option("maxWidth");j>n&&(j=n),g.option({width:j,height:k});var o="undefined"!=typeof h?h.offset:null;if(o){var p=parseFloat(o.left),q=parseFloat(o.top);p+j>window.innerWidth&&(p=window.innerWidth-j),q+k>window.innerHeight&&(q=window.innerHeight-k),l.css({position:"absolute",top:q+"px",left:p+"px"})}l.css({opacity:1})};b=$("<div class='widget' id='widget"+a.widget_id+"' data-widget-id='"+a.widget_id+"'></div>").append($("<iframe>",{src:base.options.baseUrl+"widget/run/"+a.widget_id,load:c})).dialog({appendTo:"body",title:a.title,closeOnEscape:!1,maxWidth:$("#mainContent").width(),maxHeight:$("#mainContent").height(),width:"auto",height:"auto",position:{my:"right bottom",at:"right bottom",of:"#mainContent"},close:function(a,b){base.widget.saveOption($(this).data("widget-id"),"open",0)},dragStop:function(a,b){base.widget.saveOption($(this).data("widget-id"),"offset",b.offset)},resizeStop:function(a,b){base.widget.saveOption($(this).data("widget-id"),"size",b.size)}})}else{var d=b.dialog("instance");d.open();var e=base.widget.__options[a.widget_id],f="undefined"!=typeof e?e.offset:null;if(f){var g=parseFloat(f.left),h=parseFloat(f.top),i=parseFloat(d.option("width")),j=parseFloat(d.option("height"));g+i>window.innerWidth&&(g=window.innerWidth-i),h+j>window.innerHeight&&(h=window.innerHeight-j);var k=d.widget();k.css({position:"absolute",top:h+"px",left:g+"px"})}}},__options:null,saveOption:function(a,b,c){"undefined"==typeof this.__options[a]&&(this.__options[a]={}),this.__options[a][b]=c,base.request({url:base.options.baseUrl+"widget/saveOption",data:{id:a,options:this.__options[a]}})}}}(),base.sessionValidator=function(){var a=180;return{start:function(){this.check()},check:function(){base.request({url:base.options.baseUrl+"editor/online",callback:function(a){base.sessionValidator.validate(a.online)}})},refresh:function(){this.clearAlert(),base.request({url:base.options.baseUrl+"editor/refresh",callback:function(a){base.sessionValidator.validate(a.online)}})},__validator:null,validate:function(b){if(this.__validator&&clearTimeout(this.__validator),b<=0)this.clearAlert(),location.href=base.options.baseUrl+"guest/login?returnUrl="+encodeURIComponent(location.href);else{var c=0;c=b>a&&b<2*a?b-a:parseInt(b/2),this.__validator=setTimeout(this.check,1e3*c),b<=a?this.showAlert(b):this.clearAlert()}},__time:0,showAlert:function(a){this.__time=a;var b=$("#sessionalertcontainer");b.length<=0&&(b=$(['<div id="sessionalertcontainer">','<div class="sessionalertback"></div>','<div id="sessionalert">','<div class="sessionalertinside">','<div class="expirationnotice">Your session will expire in: </div>','<div class="onlinetime"></div>','<div class="actions">','<button class="button red refresh">Stay Logged In</button>',"</div>",'<div class="desc">',"Any unsaved work will be available when you log back in.<br />You can continue right where you left off.","</div>",'<div class="clear"></div>',"</div>",'<div class="clear"></div>',"</div>",'<div class="clear"></div>',"</div>"].join("")).appendTo("body"),$(".button.refresh",b).click(function(){base.sessionValidator.refresh()})),b.show(),this.showTime()},clearAlert:function(){this.__timer&&clearTimeout(this.__timer),$("#sessionalertcontainer").hide()},__timer:null,showTime:function(){var a=parseInt(this.__time/60)+":"+this.__time%60;$("#sessionalert .onlinetime").text(a),this.__time--,this.__time<=0&&(this.__validator&&clearTimeout(this.__validator),this.clearAlert(),location.href=base.options.baseUrl+"guest/login?returnUrl="+encodeURIComponent(location.href)),this.__timer&&clearTimeout(this.__timer),this.__timer=setTimeout(function(){base.sessionValidator.showTime()},1e3)}}}(),base.saveOption=function(a,b){"undefined"==typeof b&&(b=base.thisEl),base.request({url:base.options.baseUrl+"editor/saveOption",data:{name:a,value:b}})},base.request=function(a){var b=a.callback,c=a.callbackOnFailure,d=a.showProcessing,e=a.messageForProcessing;delete a.callback,delete a.callbackOnFailure,delete a.showProcessing,delete a.messageForProcessing,"undefined"==typeof a.type&&(a.type="POST"),"undefined"==typeof a.dataType&&(a.dataType="json"),d&&base.process.start(e),$.ajax(a).done(function(a){null!=a&&"string"!=typeof a&&(a.sessionExpired&&(location.href=a.loginUrl+"?returnUrl="+encodeURIComponent(location.href)),a.status&&"undefined"!=typeof b&&b(a),d&&base.process.stop(a.messages))}).error(function(){c&&"undefined"!=typeof b&&b(!1),d&&base.process.stop(),$.notify("Unknown error occurred while processing the request.","error")})},base.showMessages=function(a){if("undefined"==typeof a&&(a=base.thisEl),a)for(var b=0,c=null;c=a[b++];)$.notify(c.msg,c.type)},base.__tweakForPlural=function(a,b,c){return"undefined"==typeof c&&(c="s"),a<=1?a+" "+b+" has been":a+" "+b+"s have been"},base.init(),base.file.init(),base.ftp()},$.sceditor.defaultOptions={activeWorkspace:null,baseUrl:"/",configAce:{setTheme:"twilight",setMode:"javascript",setTabSize:"10",setUseWrapMode:"true",fontSize:"12px",setShowPrintMargin:"true",setReadOnly:"false",treeNavigation:".sitenavdropdown",autoSetMode:!0,tabListUl:"#editorfilelist"},configTree:{treeRootElement:"#filetree",xpandSpeed:300,collapseSpeed:300,multiFolder:!0}},$.fn.sceditor=function(op){return this.each(function(){new $.sceditor(this,op)}),{call:function(e,r,popupId){return base.thisEl=r,base.popupId=popupId,eval(e)}}}}(jQuery),$(document).ready(function(){$("a").mouseover(function(){$(".sitenavdropdown.dropdownfont").removeAttr("style"),$(".sitenavdropdown.dropdownthemes").removeAttr("style")}),$(window).bind("keydown",function(a){a.ctrlKey&&122==a.which&&$('[data-action="fullScreen"]').click()})});